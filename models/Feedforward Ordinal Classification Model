{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"j6i8o2WO29yC","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651617999757,"user_tz":240,"elapsed":30118,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"2d41f1b6-0095-468f-9fff-4b752dbc7b8d"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/gdrive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/gdrive', force_remount=True)"]},{"cell_type":"markdown","metadata":{"id":"kC36zSe2Xf_1"},"source":["### **Imports & Setups**\n","\n","\n","*   Import necessary packages\n","*   Setup file paths\n","*   Setup helper method to load the pickle files\n","\n","\n","\n","\n"]},{"cell_type":"code","source":["!pip install gensim==3.8.3\n","!pip install --force-reinstall --no-deps git+https://github.com/ck37/coral-ordinal/\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rcIyFxaaw1os","executionInfo":{"status":"ok","timestamp":1651618011347,"user_tz":240,"elapsed":8083,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"38a21a3d-3447-4132-87d8-aadc050cc7b3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting gensim==3.8.3\n","  Downloading gensim-3.8.3-cp37-cp37m-manylinux1_x86_64.whl (24.2 MB)\n","\u001b[K     |████████████████████████████████| 24.2 MB 1.1 MB/s \n","\u001b[?25hRequirement already satisfied: six>=1.5.0 in /usr/local/lib/python3.7/dist-packages (from gensim==3.8.3) (1.15.0)\n","Requirement already satisfied: numpy>=1.11.3 in /usr/local/lib/python3.7/dist-packages (from gensim==3.8.3) (1.21.6)\n","Requirement already satisfied: scipy>=0.18.1 in /usr/local/lib/python3.7/dist-packages (from gensim==3.8.3) (1.4.1)\n","Requirement already satisfied: smart-open>=1.8.1 in /usr/local/lib/python3.7/dist-packages (from gensim==3.8.3) (6.0.0)\n","Installing collected packages: gensim\n","  Attempting uninstall: gensim\n","    Found existing installation: gensim 3.6.0\n","    Uninstalling gensim-3.6.0:\n","      Successfully uninstalled gensim-3.6.0\n","Successfully installed gensim-3.8.3\n","Collecting git+https://github.com/ck37/coral-ordinal/\n","  Cloning https://github.com/ck37/coral-ordinal/ to /tmp/pip-req-build-3z4tvy7x\n","  Running command git clone -q https://github.com/ck37/coral-ordinal/ /tmp/pip-req-build-3z4tvy7x\n","Building wheels for collected packages: coral-ordinal\n","  Building wheel for coral-ordinal (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for coral-ordinal: filename=coral_ordinal-0.1.9.dev0-py3-none-any.whl size=14610 sha256=d3eb6bd4a451bcb584fab985620c31dcc7088ca099ea0650804c5e3ace2c8697\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-bwe8hdm7/wheels/01/d9/85/8a6675507c6e6f1f9b890510f5b5ebd1fac5220ba0fc0893d7\n","Successfully built coral-ordinal\n","Installing collected packages: coral-ordinal\n","Successfully installed coral-ordinal-0.1.9.dev0\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YhKxV5dY7aXn"},"outputs":[],"source":["import os\n","import re\n","import pickle\n","from datetime import datetime\n","import pandas as pd\n","import numpy as np\n","\n","#### Imports needed for embedding models\n","import gensim\n","from gensim.test.utils import common_texts\n","from gensim.models import Word2Vec\n","from gensim.models import Doc2Vec\n","\n","\n","### Neural network\n","import tensorflow as tf\n","import coral_ordinal as coral\n"]},{"cell_type":"markdown","source":["#### **Setup Filepaths**"],"metadata":{"id":"n1e8_1rBs4NM"}},{"cell_type":"markdown","source":["Note: To use the same paths without any updates, you can upload the unzipped folder to your goodle drive account "],"metadata":{"id":"lSuKJ3n88rFn"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"a3-KGWKR4dlf"},"outputs":[],"source":["\n","#Path to the main directory\n","folder_path = '/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Data/'\n","\n","# Path to recipes datasets\n","recipes296k_path = folder_path + \"recipes296k_text_processed.pickle\"\n","fulldata_path    = folder_path + \"fulldata_processed.pickle\"\n","training_path    = folder_path + 'train_df.pickle'\n","testing_path     = folder_path + 'test_df.pickle'\n","\n","\n","#Path to save the embedding models\n","doc2vec_path = '/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Models/embeddings/doc2vec2_t.model'\n","\n","\n","## Classification model\n","classifier_path = '/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Models/ordinal_classifier_main'\n","\n","os.chdir(folder_path)"]},{"cell_type":"markdown","source":["**Display Options**"],"metadata":{"id":"_pHhk00kqdhz"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"l4qioPh0ySkI"},"outputs":[],"source":["pd.set_option('display.max_colwidth', 2000)\n","pd.set_option('display.max_rows', 500)\n","pd.set_option('display.max_columns', 500)\n","pd.set_option('display.width', 1000)"]},{"cell_type":"markdown","source":["##### **Helper Methods**"],"metadata":{"id":"XuGj5lSnqOe0"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1651618015132,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"},"user_tz":240},"id":"MAbdPq0tciwd","outputId":"147e2ef9-c291-45e4-b14c-7beda2c82f0d"},"outputs":[{"output_type":"stream","name":"stdout","text":["[2022-05-03 22:46:55.029632]: Success!\n"]}],"source":["def now(phrase):\n","    print(f\"[{datetime.now()}]: {phrase}\")\n","    \n","now(\"Success!\")\n","def load(filename):\n","    now(\"starting\")\n","    if (os.path.exists(filename)):\n","        with open(filename, 'rb') as f:\n","            data = pickle.load(f)\n","        now(\"ending\")\n","        return data\n","    else:\n","        raise FileNotFoundError(f\"could not find {filename}\")\n","\n","\n","## saves as pickle object\n","def save(filename, obj):\n","    now(\"Starting\")\n","    with open(filename, 'wb') as f:\n","        pickle.dump(obj, f)\n","        print(f\"Saved obj Object to {filename}!\")\n","    now(\"Ending\")\n","    return ''"]},{"cell_type":"markdown","source":["### **Load Dataset**"],"metadata":{"id":"5R6MC7X-rFyI"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Vyv3VzkqcWyT","outputId":"5aa24f68-48ba-4d03-f85f-7f65e001f7ba","executionInfo":{"status":"ok","timestamp":1651618026917,"user_tz":240,"elapsed":10194,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["[2022-05-03 22:46:56.737831]: starting\n","[2022-05-03 22:47:00.603005]: ending\n","[2022-05-03 22:47:00.604105]: starting\n","[2022-05-03 22:47:01.955485]: ending\n","[2022-05-03 22:47:01.955748]: starting\n","[2022-05-03 22:47:06.773909]: ending\n"]}],"source":["## Load training data\n","training_data = load(training_path)\n","\n","## Load testing data\n","testing_data  = load(testing_path)\n","\n","### Load the full dataset\n","all_recipes = load(fulldata_path)\n","\n","# reset index of the dataframe to keep the indices ordered consecutively\n","all_recipes.reset_index(inplace=True, drop='index')\n","# now reset again to add the new indices as a separate column as well\n","all_recipes.reset_index(inplace=True)"]},{"cell_type":"markdown","source":["#### **Prepare Data for Training**"],"metadata":{"id":"-IOMBxhsWlWk"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Ao1e-04MJ4i","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651618028961,"user_tz":240,"elapsed":2047,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"214608ed-5475-4428-e938-cf53c467f3e3"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:18: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:19: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:24: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:25: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:30: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:31: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n"]}],"source":["### training data with the document id\n","training_data = training_data.merge(all_recipes[['RecipeId','index']], how='inner', left_on='RecipeId', right_on='RecipeId')\n","\n","### testing data with the document id\n","testing_data = testing_data.merge(all_recipes[['RecipeId','index']], how='inner', left_on='RecipeId', right_on='RecipeId')\n","\n","### Merge the list to text\n","def merge_list(input_list):\n","  return \" \".join(input_list)\n","  \n","# Full dataset\n","data = all_recipes\n","text_feature = data[[\"RecipeId\",\"Name\",\"RecipeCategory\",'RatingId','RecipeIngredientParts','RecipeInstructions']]\n","text_feature.reset_index(inplace=True, drop='index')\n","text_feature.reset_index(inplace=True)\n","\n","\n","text_feature['RecipeIngredientParts'] = text_feature['RecipeIngredientParts'].apply(merge_list)\n","text_feature['Recipe'] = text_feature['RecipeIngredientParts'].astype(str) + \" \"+ text_feature['RecipeInstructions']\n","\n","# Training data`\n","data = training_data\n","training_data = data[[\"index\",\"RecipeId\",\"Name\",\"RecipeCategory\",'RatingId','RecipeIngredientParts','RecipeInstructions']]\n","training_data['RecipeIngredientParts'] = training_data['RecipeIngredientParts'].apply(merge_list)\n","training_data['Recipe'] = training_data['RecipeIngredientParts'].astype(str) + \" \"+ training_data['RecipeInstructions']\n","\n","# Testing data\n","data = testing_data\n","testing_data = data[[\"index\",\"RecipeId\",\"Name\",\"RecipeCategory\",'RatingId','RecipeIngredientParts','RecipeInstructions']]\n","testing_data['RecipeIngredientParts'] = testing_data['RecipeIngredientParts'].apply(merge_list)\n","testing_data['Recipe'] = testing_data['RecipeIngredientParts'].astype(str) + \" \"+ testing_data['RecipeInstructions']"]},{"cell_type":"markdown","source":["#### **Understanding the dataset**"],"metadata":{"id":"na2otCwqvaw_"}},{"cell_type":"code","source":["print(len(text_feature))\n","text_feature.head(1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":264},"id":"R4FVTvQDbd3r","executionInfo":{"status":"ok","timestamp":1651546442606,"user_tz":240,"elapsed":21,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"c9f2bea5-bb7d-4abe-f412-665d4dc871bc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["269294\n"]},{"output_type":"execute_result","data":{"text/plain":["   index  RecipeId                               Name   RecipeCategory RatingId                                    RecipeIngredientParts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   RecipeInstructions  \\\n","0      0        38  Low-Fat Berry Blue Frozen Dessert  Frozen Desserts        4  blueberries granulated-sugar vanilla-yogurt lemon-juice  <s> toss 2 cup berry sugar </s> <s> let stand 45 minute stir occasionally </s> <s> transfer berry sugar mixture food processor </s> <s> add yogurt process smooth </s> <s> strain fine sieve </s> <s> pour bake pan transfer ice cream maker process accord manufacturer direction </s> <s> freeze uncover edge solid centre soft </s> <s> transfer processor blend smooth </s> <s> return pan freeze edge solid </s> <s> transfer processor blend smooth </s> <s> fold remain 2 cup blueberry </s> <s> pour plastic mold freeze overnight </s> <s> let soften slightly serve </s>    \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Recipe  \n","0  blueberries granulated-sugar vanilla-yogurt lemon-juice <s> toss 2 cup berry sugar </s> <s> let stand 45 minute stir occasionally </s> <s> transfer berry sugar mixture food processor </s> <s> add yogurt process smooth </s> <s> strain fine sieve </s> <s> pour bake pan transfer ice cream maker process accord manufacturer direction </s> <s> freeze uncover edge solid centre soft </s> <s> transfer processor blend smooth </s> <s> return pan freeze edge solid </s> <s> transfer processor blend smooth </s> <s> fold remain 2 cup blueberry </s> <s> pour plastic mold freeze overnight </s> <s> let soften slightly serve </s>   "],"text/html":["\n","  <div id=\"df-7eaa5ca5-1398-4c99-8c55-245821f6198a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>38</td>\n","      <td>Low-Fat Berry Blue Frozen Dessert</td>\n","      <td>Frozen Desserts</td>\n","      <td>4</td>\n","      <td>blueberries granulated-sugar vanilla-yogurt lemon-juice</td>\n","      <td>&lt;s&gt; toss 2 cup berry sugar &lt;/s&gt; &lt;s&gt; let stand 45 minute stir occasionally &lt;/s&gt; &lt;s&gt; transfer berry sugar mixture food processor &lt;/s&gt; &lt;s&gt; add yogurt process smooth &lt;/s&gt; &lt;s&gt; strain fine sieve &lt;/s&gt; &lt;s&gt; pour bake pan transfer ice cream maker process accord manufacturer direction &lt;/s&gt; &lt;s&gt; freeze uncover edge solid centre soft &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; return pan freeze edge solid &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; fold remain 2 cup blueberry &lt;/s&gt; &lt;s&gt; pour plastic mold freeze overnight &lt;/s&gt; &lt;s&gt; let soften slightly serve &lt;/s&gt;</td>\n","      <td>blueberries granulated-sugar vanilla-yogurt lemon-juice &lt;s&gt; toss 2 cup berry sugar &lt;/s&gt; &lt;s&gt; let stand 45 minute stir occasionally &lt;/s&gt; &lt;s&gt; transfer berry sugar mixture food processor &lt;/s&gt; &lt;s&gt; add yogurt process smooth &lt;/s&gt; &lt;s&gt; strain fine sieve &lt;/s&gt; &lt;s&gt; pour bake pan transfer ice cream maker process accord manufacturer direction &lt;/s&gt; &lt;s&gt; freeze uncover edge solid centre soft &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; return pan freeze edge solid &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; fold remain 2 cup blueberry &lt;/s&gt; &lt;s&gt; pour plastic mold freeze overnight &lt;/s&gt; &lt;s&gt; let soften slightly serve &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7eaa5ca5-1398-4c99-8c55-245821f6198a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7eaa5ca5-1398-4c99-8c55-245821f6198a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7eaa5ca5-1398-4c99-8c55-245821f6198a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":92}]},{"cell_type":"code","source":["print(len(training_data))\n","training_data.head(1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":212},"id":"F-sntYSocL-S","executionInfo":{"status":"ok","timestamp":1651546442606,"user_tz":240,"elapsed":15,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"301b4f1e-54bb-4e1d-9e21-932104ca857a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["201970\n"]},{"output_type":"execute_result","data":{"text/plain":["    index  RecipeId                         Name RecipeCategory RatingId                                 RecipeIngredientParts                                                                                                                                                                                                                                                                                                         RecipeInstructions                                                                                                                                                                                                                                                                                                                                                                          Recipe\n","0  235422    406189  Dulce De Leche Rice Pudding        Dessert        5  milk cinnamon-sticks ground-cinnamon long-grain-rice  <s> heat milk cinnamon stick large saucepan medium high heat reach boil remove cinnamon stick </s> <s> reduce heat medium low add rice </s> <s> cook stir frequently 15 20 minute </s> <s> add dulce de leche cook stir frequently 15 20 minute rice tender sauce thicken </s> <s> garnish slice fresh fruit desire </s>   milk cinnamon-sticks ground-cinnamon long-grain-rice <s> heat milk cinnamon stick large saucepan medium high heat reach boil remove cinnamon stick </s> <s> reduce heat medium low add rice </s> <s> cook stir frequently 15 20 minute </s> <s> add dulce de leche cook stir frequently 15 20 minute rice tender sauce thicken </s> <s> garnish slice fresh fruit desire </s> "],"text/html":["\n","  <div id=\"df-5444df9f-dc05-4690-951e-4bfbe6238975\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>235422</td>\n","      <td>406189</td>\n","      <td>Dulce De Leche Rice Pudding</td>\n","      <td>Dessert</td>\n","      <td>5</td>\n","      <td>milk cinnamon-sticks ground-cinnamon long-grain-rice</td>\n","      <td>&lt;s&gt; heat milk cinnamon stick large saucepan medium high heat reach boil remove cinnamon stick &lt;/s&gt; &lt;s&gt; reduce heat medium low add rice &lt;/s&gt; &lt;s&gt; cook stir frequently 15 20 minute &lt;/s&gt; &lt;s&gt; add dulce de leche cook stir frequently 15 20 minute rice tender sauce thicken &lt;/s&gt; &lt;s&gt; garnish slice fresh fruit desire &lt;/s&gt;</td>\n","      <td>milk cinnamon-sticks ground-cinnamon long-grain-rice &lt;s&gt; heat milk cinnamon stick large saucepan medium high heat reach boil remove cinnamon stick &lt;/s&gt; &lt;s&gt; reduce heat medium low add rice &lt;/s&gt; &lt;s&gt; cook stir frequently 15 20 minute &lt;/s&gt; &lt;s&gt; add dulce de leche cook stir frequently 15 20 minute rice tender sauce thicken &lt;/s&gt; &lt;s&gt; garnish slice fresh fruit desire &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5444df9f-dc05-4690-951e-4bfbe6238975')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5444df9f-dc05-4690-951e-4bfbe6238975 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5444df9f-dc05-4690-951e-4bfbe6238975');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":93}]},{"cell_type":"code","source":["print(len(testing_data))\n","testing_data.head(1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":159},"id":"HS7LKBXScPmH","executionInfo":{"status":"ok","timestamp":1651546442607,"user_tz":240,"elapsed":12,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"3020f2a0-18e4-418c-a83d-437c0816b3de"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["67324\n"]},{"output_type":"execute_result","data":{"text/plain":["   index  RecipeId                          Name RecipeCategory RatingId                                                  RecipeIngredientParts                                                                    RecipeInstructions                                                                                                                                                      Recipe\n","0  44736     62218  Tasty Twist on Chicken Salad   Lunch/Snacks        5  boneless-skinless-chicken-breast celery jicama green-onion mayonnaise  <s> add ingredient bowl stir well </s> <s> enjoy like mine straight bowl bread </s>   boneless-skinless-chicken-breast celery jicama green-onion mayonnaise <s> add ingredient bowl stir well </s> <s> enjoy like mine straight bowl bread </s> "],"text/html":["\n","  <div id=\"df-2fd22891-94f2-4f22-abcd-cfd4a420a2a4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>44736</td>\n","      <td>62218</td>\n","      <td>Tasty Twist on Chicken Salad</td>\n","      <td>Lunch/Snacks</td>\n","      <td>5</td>\n","      <td>boneless-skinless-chicken-breast celery jicama green-onion mayonnaise</td>\n","      <td>&lt;s&gt; add ingredient bowl stir well &lt;/s&gt; &lt;s&gt; enjoy like mine straight bowl bread &lt;/s&gt;</td>\n","      <td>boneless-skinless-chicken-breast celery jicama green-onion mayonnaise &lt;s&gt; add ingredient bowl stir well &lt;/s&gt; &lt;s&gt; enjoy like mine straight bowl bread &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2fd22891-94f2-4f22-abcd-cfd4a420a2a4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2fd22891-94f2-4f22-abcd-cfd4a420a2a4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2fd22891-94f2-4f22-abcd-cfd4a420a2a4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":94}]},{"cell_type":"markdown","source":["### **Load the saved Doc2Vec Embedding Model**\n","\n","*   Load the pre-trained doc2vec model trained on the recipe dataset\n","*   Test Similar Recipes\n","*   Convert the model and prepare meta-data for visualization in tensorflow embedding projector\n","\n"],"metadata":{"id":"peKirhuuzi5p"}},{"cell_type":"code","source":["###### Model 1\n","from gensim.models.doc2vec import Doc2Vec\n","\n","# doc2vec_path = '/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/archive/doc2vec2_t.model'\n","doc2vec_model   = Doc2Vec.load(doc2vec_path)\n"],"metadata":{"id":"4goYjE1pzh-0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["doc2vec_model.docvecs[0]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NGYi7DxERFAd","executionInfo":{"status":"ok","timestamp":1651618032688,"user_tz":240,"elapsed":6,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"2e6b31c9-86c8-46da-eaed-92964f34efcf"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([-0.67104775,  0.28307813,  0.737946  ,  0.3985006 ,  0.49221504,\n","       -0.8778497 , -0.28440645,  0.61967134, -1.2615206 , -0.49930638,\n","        0.5837085 ,  0.1175489 ,  0.06379298, -0.22750738,  0.17585632,\n","        0.47683293, -0.49880403, -1.0964055 , -0.27218783, -0.5743127 ,\n","       -1.4270345 , -0.5266007 , -0.0739331 , -0.9465427 ,  0.05609548,\n","        0.8913738 ,  0.28346667,  0.9714314 ,  0.43279567, -0.55803007,\n","       -0.9037891 , -0.4056593 , -0.1922238 , -0.2740505 , -0.9092181 ,\n","       -0.8722193 ,  0.3717816 ,  1.6154871 ,  0.7916882 , -1.0482035 ,\n","       -0.23578274,  0.9014744 ,  0.14754438, -0.6919935 ,  1.1490105 ,\n","       -0.3776072 ,  0.09313972, -0.31556588, -0.67811465,  1.9491652 ],\n","      dtype=float32)"]},"metadata":{},"execution_count":10}]},{"cell_type":"markdown","source":["#### **Find similar documents**"],"metadata":{"id":"42fEhGO0V2Kc"}},{"cell_type":"code","source":["# doc2vec model \n","\n","## try any index of the recipe\n","index = 0\n","example = text_feature['RecipeInstructions'][index].split()\n","\n","print(example)\n","inferred_vector1 = doc2vec_model.infer_vector(example)\n","sims1  = doc2vec_model.docvecs.most_similar([inferred_vector1])\n","\n","# print(inferred_vector)\n","print(sims1)\n","\n","print(\"\\nDocument\")\n","print(example)\n","display(text_feature.iloc[[index]])\n","# print(\"keywords\",text_feature['Keywords'][2])\n","\n","\n","sims1\n","print(\"\\nSimilar Documents\")\n","for i in range(len(sims1)):\n","  print('index: ', sims1[i][0])\n","  # print(\"\\nKeywords\", text_feature['Keywords'][sims1[i][0]])\n","  print(\"Similarity: \", sims1[i][1]) #d[sims1[i][0]]\n","  # print(sims1[i][0])\n","  print(\"Recipe: \")\n","  display(text_feature.iloc[[sims1[i][0]]])\n","\n","## Doc 1 seems most similar to doc ..?\n","# print(' '.join(data[sims2[0][0]])+'\\n')"],"metadata":{"id":"ZAQB7yG6y7E5","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1651618034619,"user_tz":240,"elapsed":710,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"f9940878-5728-4f63-a0b8-3933f41f90cf"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['<s>', 'toss', '2', 'cup', 'berry', 'sugar', '</s>', '<s>', 'let', 'stand', '45', 'minute', 'stir', 'occasionally', '</s>', '<s>', 'transfer', 'berry', 'sugar', 'mixture', 'food', 'processor', '</s>', '<s>', 'add', 'yogurt', 'process', 'smooth', '</s>', '<s>', 'strain', 'fine', 'sieve', '</s>', '<s>', 'pour', 'bake', 'pan', 'transfer', 'ice', 'cream', 'maker', 'process', 'accord', 'manufacturer', 'direction', '</s>', '<s>', 'freeze', 'uncover', 'edge', 'solid', 'centre', 'soft', '</s>', '<s>', 'transfer', 'processor', 'blend', 'smooth', '</s>', '<s>', 'return', 'pan', 'freeze', 'edge', 'solid', '</s>', '<s>', 'transfer', 'processor', 'blend', 'smooth', '</s>', '<s>', 'fold', 'remain', '2', 'cup', 'blueberry', '</s>', '<s>', 'pour', 'plastic', 'mold', 'freeze', 'overnight', '</s>', '<s>', 'let', 'soften', 'slightly', 'serve', '</s>']\n","[(0, 0.9658677577972412), (22543, 0.6774750351905823), (215988, 0.6744435429573059), (22494, 0.673481285572052), (153999, 0.6697591543197632), (255976, 0.6549301743507385), (253521, 0.6360390782356262), (229364, 0.6349404454231262), (26358, 0.6339403390884399), (246777, 0.6321957111358643)]\n","\n","Document\n","['<s>', 'toss', '2', 'cup', 'berry', 'sugar', '</s>', '<s>', 'let', 'stand', '45', 'minute', 'stir', 'occasionally', '</s>', '<s>', 'transfer', 'berry', 'sugar', 'mixture', 'food', 'processor', '</s>', '<s>', 'add', 'yogurt', 'process', 'smooth', '</s>', '<s>', 'strain', 'fine', 'sieve', '</s>', '<s>', 'pour', 'bake', 'pan', 'transfer', 'ice', 'cream', 'maker', 'process', 'accord', 'manufacturer', 'direction', '</s>', '<s>', 'freeze', 'uncover', 'edge', 'solid', 'centre', 'soft', '</s>', '<s>', 'transfer', 'processor', 'blend', 'smooth', '</s>', '<s>', 'return', 'pan', 'freeze', 'edge', 'solid', '</s>', '<s>', 'transfer', 'processor', 'blend', 'smooth', '</s>', '<s>', 'fold', 'remain', '2', 'cup', 'blueberry', '</s>', '<s>', 'pour', 'plastic', 'mold', 'freeze', 'overnight', '</s>', '<s>', 'let', 'soften', 'slightly', 'serve', '</s>']\n"]},{"output_type":"display_data","data":{"text/plain":["   index  RecipeId                               Name   RecipeCategory RatingId                                    RecipeIngredientParts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   RecipeInstructions  \\\n","0      0        38  Low-Fat Berry Blue Frozen Dessert  Frozen Desserts        4  blueberries granulated-sugar vanilla-yogurt lemon-juice  <s> toss 2 cup berry sugar </s> <s> let stand 45 minute stir occasionally </s> <s> transfer berry sugar mixture food processor </s> <s> add yogurt process smooth </s> <s> strain fine sieve </s> <s> pour bake pan transfer ice cream maker process accord manufacturer direction </s> <s> freeze uncover edge solid centre soft </s> <s> transfer processor blend smooth </s> <s> return pan freeze edge solid </s> <s> transfer processor blend smooth </s> <s> fold remain 2 cup blueberry </s> <s> pour plastic mold freeze overnight </s> <s> let soften slightly serve </s>    \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Recipe  \n","0  blueberries granulated-sugar vanilla-yogurt lemon-juice <s> toss 2 cup berry sugar </s> <s> let stand 45 minute stir occasionally </s> <s> transfer berry sugar mixture food processor </s> <s> add yogurt process smooth </s> <s> strain fine sieve </s> <s> pour bake pan transfer ice cream maker process accord manufacturer direction </s> <s> freeze uncover edge solid centre soft </s> <s> transfer processor blend smooth </s> <s> return pan freeze edge solid </s> <s> transfer processor blend smooth </s> <s> fold remain 2 cup blueberry </s> <s> pour plastic mold freeze overnight </s> <s> let soften slightly serve </s>   "],"text/html":["\n","  <div id=\"df-d6ad0e40-d59f-4798-abc9-5d022c65399a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>38</td>\n","      <td>Low-Fat Berry Blue Frozen Dessert</td>\n","      <td>Frozen Desserts</td>\n","      <td>4</td>\n","      <td>blueberries granulated-sugar vanilla-yogurt lemon-juice</td>\n","      <td>&lt;s&gt; toss 2 cup berry sugar &lt;/s&gt; &lt;s&gt; let stand 45 minute stir occasionally &lt;/s&gt; &lt;s&gt; transfer berry sugar mixture food processor &lt;/s&gt; &lt;s&gt; add yogurt process smooth &lt;/s&gt; &lt;s&gt; strain fine sieve &lt;/s&gt; &lt;s&gt; pour bake pan transfer ice cream maker process accord manufacturer direction &lt;/s&gt; &lt;s&gt; freeze uncover edge solid centre soft &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; return pan freeze edge solid &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; fold remain 2 cup blueberry &lt;/s&gt; &lt;s&gt; pour plastic mold freeze overnight &lt;/s&gt; &lt;s&gt; let soften slightly serve &lt;/s&gt;</td>\n","      <td>blueberries granulated-sugar vanilla-yogurt lemon-juice &lt;s&gt; toss 2 cup berry sugar &lt;/s&gt; &lt;s&gt; let stand 45 minute stir occasionally &lt;/s&gt; &lt;s&gt; transfer berry sugar mixture food processor &lt;/s&gt; &lt;s&gt; add yogurt process smooth &lt;/s&gt; &lt;s&gt; strain fine sieve &lt;/s&gt; &lt;s&gt; pour bake pan transfer ice cream maker process accord manufacturer direction &lt;/s&gt; &lt;s&gt; freeze uncover edge solid centre soft &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; return pan freeze edge solid &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; fold remain 2 cup blueberry &lt;/s&gt; &lt;s&gt; pour plastic mold freeze overnight &lt;/s&gt; &lt;s&gt; let soften slightly serve &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d6ad0e40-d59f-4798-abc9-5d022c65399a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d6ad0e40-d59f-4798-abc9-5d022c65399a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d6ad0e40-d59f-4798-abc9-5d022c65399a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n","Similar Documents\n","index:  0\n","Similarity:  0.9658677577972412\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["   index  RecipeId                               Name   RecipeCategory RatingId                                    RecipeIngredientParts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   RecipeInstructions  \\\n","0      0        38  Low-Fat Berry Blue Frozen Dessert  Frozen Desserts        4  blueberries granulated-sugar vanilla-yogurt lemon-juice  <s> toss 2 cup berry sugar </s> <s> let stand 45 minute stir occasionally </s> <s> transfer berry sugar mixture food processor </s> <s> add yogurt process smooth </s> <s> strain fine sieve </s> <s> pour bake pan transfer ice cream maker process accord manufacturer direction </s> <s> freeze uncover edge solid centre soft </s> <s> transfer processor blend smooth </s> <s> return pan freeze edge solid </s> <s> transfer processor blend smooth </s> <s> fold remain 2 cup blueberry </s> <s> pour plastic mold freeze overnight </s> <s> let soften slightly serve </s>    \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Recipe  \n","0  blueberries granulated-sugar vanilla-yogurt lemon-juice <s> toss 2 cup berry sugar </s> <s> let stand 45 minute stir occasionally </s> <s> transfer berry sugar mixture food processor </s> <s> add yogurt process smooth </s> <s> strain fine sieve </s> <s> pour bake pan transfer ice cream maker process accord manufacturer direction </s> <s> freeze uncover edge solid centre soft </s> <s> transfer processor blend smooth </s> <s> return pan freeze edge solid </s> <s> transfer processor blend smooth </s> <s> fold remain 2 cup blueberry </s> <s> pour plastic mold freeze overnight </s> <s> let soften slightly serve </s>   "],"text/html":["\n","  <div id=\"df-37802a6e-3e0c-457b-84e3-f7f996318dbb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>38</td>\n","      <td>Low-Fat Berry Blue Frozen Dessert</td>\n","      <td>Frozen Desserts</td>\n","      <td>4</td>\n","      <td>blueberries granulated-sugar vanilla-yogurt lemon-juice</td>\n","      <td>&lt;s&gt; toss 2 cup berry sugar &lt;/s&gt; &lt;s&gt; let stand 45 minute stir occasionally &lt;/s&gt; &lt;s&gt; transfer berry sugar mixture food processor &lt;/s&gt; &lt;s&gt; add yogurt process smooth &lt;/s&gt; &lt;s&gt; strain fine sieve &lt;/s&gt; &lt;s&gt; pour bake pan transfer ice cream maker process accord manufacturer direction &lt;/s&gt; &lt;s&gt; freeze uncover edge solid centre soft &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; return pan freeze edge solid &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; fold remain 2 cup blueberry &lt;/s&gt; &lt;s&gt; pour plastic mold freeze overnight &lt;/s&gt; &lt;s&gt; let soften slightly serve &lt;/s&gt;</td>\n","      <td>blueberries granulated-sugar vanilla-yogurt lemon-juice &lt;s&gt; toss 2 cup berry sugar &lt;/s&gt; &lt;s&gt; let stand 45 minute stir occasionally &lt;/s&gt; &lt;s&gt; transfer berry sugar mixture food processor &lt;/s&gt; &lt;s&gt; add yogurt process smooth &lt;/s&gt; &lt;s&gt; strain fine sieve &lt;/s&gt; &lt;s&gt; pour bake pan transfer ice cream maker process accord manufacturer direction &lt;/s&gt; &lt;s&gt; freeze uncover edge solid centre soft &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; return pan freeze edge solid &lt;/s&gt; &lt;s&gt; transfer processor blend smooth &lt;/s&gt; &lt;s&gt; fold remain 2 cup blueberry &lt;/s&gt; &lt;s&gt; pour plastic mold freeze overnight &lt;/s&gt; &lt;s&gt; let soften slightly serve &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-37802a6e-3e0c-457b-84e3-f7f996318dbb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-37802a6e-3e0c-457b-84e3-f7f996318dbb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-37802a6e-3e0c-457b-84e3-f7f996318dbb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  22543\n","Similarity:  0.6774750351905823\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["       index  RecipeId                          Name RecipeCategory RatingId  RecipeIngredientParts                                                                                                                                                            RecipeInstructions                                                                                                                                                                                              Recipe\n","22543  22543     32461  Watermelon-Lemonade Ice Pops        Dessert        4  watermelon sugar salt  <s> combine ingredient processor </s> <s> puree smooth </s> <s> divide mixture among 8 ice pop mold 1/4 1/3 cup capacity </s> <s> cover freeze firm least 4 hour 5 day </s>   watermelon sugar salt <s> combine ingredient processor </s> <s> puree smooth </s> <s> divide mixture among 8 ice pop mold 1/4 1/3 cup capacity </s> <s> cover freeze firm least 4 hour 5 day </s> "],"text/html":["\n","  <div id=\"df-fa5846ba-fef4-4474-89d6-dabb6948aa42\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>22543</th>\n","      <td>22543</td>\n","      <td>32461</td>\n","      <td>Watermelon-Lemonade Ice Pops</td>\n","      <td>Dessert</td>\n","      <td>4</td>\n","      <td>watermelon sugar salt</td>\n","      <td>&lt;s&gt; combine ingredient processor &lt;/s&gt; &lt;s&gt; puree smooth &lt;/s&gt; &lt;s&gt; divide mixture among 8 ice pop mold 1/4 1/3 cup capacity &lt;/s&gt; &lt;s&gt; cover freeze firm least 4 hour 5 day &lt;/s&gt;</td>\n","      <td>watermelon sugar salt &lt;s&gt; combine ingredient processor &lt;/s&gt; &lt;s&gt; puree smooth &lt;/s&gt; &lt;s&gt; divide mixture among 8 ice pop mold 1/4 1/3 cup capacity &lt;/s&gt; &lt;s&gt; cover freeze firm least 4 hour 5 day &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fa5846ba-fef4-4474-89d6-dabb6948aa42')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fa5846ba-fef4-4474-89d6-dabb6948aa42 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fa5846ba-fef4-4474-89d6-dabb6948aa42');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  215988\n","Similarity:  0.6744435429573059\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["         index  RecipeId                                  Name   RecipeCategory RatingId                                                                                                                                                               RecipeIngredientParts  \\\n","215988  215988    359760  Ricotta Gelato With Blackberry Sauce  Frozen Desserts        5  half-and-half milk whole-milk-ricotta-cheese sugar cinnamon-sticks lemon-zest light-corn-syrup vanilla sugar water blackberries fresh-lemon-juice creme-de-cassis mango blackberry   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         RecipeInstructions  \\\n","215988  <s> make gelato saucepan whisk together half half milk ricotta sugar add cinnamon stick bring mixture boil stir </s> <s> remove pan heat add zest let mixture stand cover 10 minute </s> <s> force mixture fine sieve set bowl stir corn syrup vanilla </s> <s> chill mixture cover cold freeze ice cream freezer accord manufacturer instruction </s> <s> pack gelato tightly six 1/2 cup dariole mold cover mold plastic wrap freeze gelato 30 minute ready serve </s> <s> make blackberry sauce heavy saucepan melt sugar moderate heat stir fork cook syrup swirl pan occasionally golden caramel </s> <s> work carefully quickly stir water blackberry lemon juice crème de cassis mixture bubble stir mixture combine well cook mixture moderately low heat caramel dissolve </s> <s> strain mixture fine sieve set bowl press hard solid chill sauce cover cold </s> <s> divide sauce among 6 dessert plate unmold gelato arrange center plate </s> <s> garnish serve mango blackberry </s>    \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Recipe  \n","215988  half-and-half milk whole-milk-ricotta-cheese sugar cinnamon-sticks lemon-zest light-corn-syrup vanilla sugar water blackberries fresh-lemon-juice creme-de-cassis mango blackberry <s> make gelato saucepan whisk together half half milk ricotta sugar add cinnamon stick bring mixture boil stir </s> <s> remove pan heat add zest let mixture stand cover 10 minute </s> <s> force mixture fine sieve set bowl stir corn syrup vanilla </s> <s> chill mixture cover cold freeze ice cream freezer accord manufacturer instruction </s> <s> pack gelato tightly six 1/2 cup dariole mold cover mold plastic wrap freeze gelato 30 minute ready serve </s> <s> make blackberry sauce heavy saucepan melt sugar moderate heat stir fork cook syrup swirl pan occasionally golden caramel </s> <s> work carefully quickly stir water blackberry lemon juice crème de cassis mixture bubble stir mixture combine well cook mixture moderately low heat caramel dissolve </s> <s> strain mixture fine sieve set bowl press hard solid chill sauce cover cold </s> <s> divide sauce among 6 dessert plate unmold gelato arrange center plate </s> <s> garnish serve mango blackberry </s>   "],"text/html":["\n","  <div id=\"df-84cedbc2-72da-4f8a-9a70-6c98bb91d75f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>215988</th>\n","      <td>215988</td>\n","      <td>359760</td>\n","      <td>Ricotta Gelato With Blackberry Sauce</td>\n","      <td>Frozen Desserts</td>\n","      <td>5</td>\n","      <td>half-and-half milk whole-milk-ricotta-cheese sugar cinnamon-sticks lemon-zest light-corn-syrup vanilla sugar water blackberries fresh-lemon-juice creme-de-cassis mango blackberry</td>\n","      <td>&lt;s&gt; make gelato saucepan whisk together half half milk ricotta sugar add cinnamon stick bring mixture boil stir &lt;/s&gt; &lt;s&gt; remove pan heat add zest let mixture stand cover 10 minute &lt;/s&gt; &lt;s&gt; force mixture fine sieve set bowl stir corn syrup vanilla &lt;/s&gt; &lt;s&gt; chill mixture cover cold freeze ice cream freezer accord manufacturer instruction &lt;/s&gt; &lt;s&gt; pack gelato tightly six 1/2 cup dariole mold cover mold plastic wrap freeze gelato 30 minute ready serve &lt;/s&gt; &lt;s&gt; make blackberry sauce heavy saucepan melt sugar moderate heat stir fork cook syrup swirl pan occasionally golden caramel &lt;/s&gt; &lt;s&gt; work carefully quickly stir water blackberry lemon juice crème de cassis mixture bubble stir mixture combine well cook mixture moderately low heat caramel dissolve &lt;/s&gt; &lt;s&gt; strain mixture fine sieve set bowl press hard solid chill sauce cover cold &lt;/s&gt; &lt;s&gt; divide sauce among 6 dessert plate unmold gelato arrange center plate &lt;/s&gt; &lt;s&gt; garnish serve mango blackberry &lt;/s&gt;</td>\n","      <td>half-and-half milk whole-milk-ricotta-cheese sugar cinnamon-sticks lemon-zest light-corn-syrup vanilla sugar water blackberries fresh-lemon-juice creme-de-cassis mango blackberry &lt;s&gt; make gelato saucepan whisk together half half milk ricotta sugar add cinnamon stick bring mixture boil stir &lt;/s&gt; &lt;s&gt; remove pan heat add zest let mixture stand cover 10 minute &lt;/s&gt; &lt;s&gt; force mixture fine sieve set bowl stir corn syrup vanilla &lt;/s&gt; &lt;s&gt; chill mixture cover cold freeze ice cream freezer accord manufacturer instruction &lt;/s&gt; &lt;s&gt; pack gelato tightly six 1/2 cup dariole mold cover mold plastic wrap freeze gelato 30 minute ready serve &lt;/s&gt; &lt;s&gt; make blackberry sauce heavy saucepan melt sugar moderate heat stir fork cook syrup swirl pan occasionally golden caramel &lt;/s&gt; &lt;s&gt; work carefully quickly stir water blackberry lemon juice crème de cassis mixture bubble stir mixture combine well cook mixture moderately low heat caramel dissolve &lt;/s&gt; &lt;s&gt; strain mixture fine sieve set bowl press hard solid chill sauce cover cold &lt;/s&gt; &lt;s&gt; divide sauce among 6 dessert plate unmold gelato arrange center plate &lt;/s&gt; &lt;s&gt; garnish serve mango blackberry &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-84cedbc2-72da-4f8a-9a70-6c98bb91d75f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-84cedbc2-72da-4f8a-9a70-6c98bb91d75f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-84cedbc2-72da-4f8a-9a70-6c98bb91d75f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  22494\n","Similarity:  0.673481285572052\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["       index  RecipeId                      Name   RecipeCategory RatingId                RecipeIngredientParts                                                                                                                                                   RecipeInstructions                                                                                                                                                                                                   Recipe\n","22494  22494     32394  Royal Blueberry Ice Pops  Frozen Desserts        5  fresh-blueberries water honey sugar  <s> combine ingredient processor puree smooth </s> <s> divide mixture among 8 ice pop mold 1/4 1/3 cup capacity </s> <s> cover freeze firm least 4 hour 5 day </s>   fresh-blueberries water honey sugar <s> combine ingredient processor puree smooth </s> <s> divide mixture among 8 ice pop mold 1/4 1/3 cup capacity </s> <s> cover freeze firm least 4 hour 5 day </s> "],"text/html":["\n","  <div id=\"df-e9029f10-6772-4d4a-b808-b9ee4c53bed5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>22494</th>\n","      <td>22494</td>\n","      <td>32394</td>\n","      <td>Royal Blueberry Ice Pops</td>\n","      <td>Frozen Desserts</td>\n","      <td>5</td>\n","      <td>fresh-blueberries water honey sugar</td>\n","      <td>&lt;s&gt; combine ingredient processor puree smooth &lt;/s&gt; &lt;s&gt; divide mixture among 8 ice pop mold 1/4 1/3 cup capacity &lt;/s&gt; &lt;s&gt; cover freeze firm least 4 hour 5 day &lt;/s&gt;</td>\n","      <td>fresh-blueberries water honey sugar &lt;s&gt; combine ingredient processor puree smooth &lt;/s&gt; &lt;s&gt; divide mixture among 8 ice pop mold 1/4 1/3 cup capacity &lt;/s&gt; &lt;s&gt; cover freeze firm least 4 hour 5 day &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e9029f10-6772-4d4a-b808-b9ee4c53bed5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e9029f10-6772-4d4a-b808-b9ee4c53bed5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e9029f10-6772-4d4a-b808-b9ee4c53bed5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  153999\n","Similarity:  0.6697591543197632\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["         index  RecipeId                  Name RecipeCategory RatingId                                                                                                           RecipeIngredientParts                                                                                                                                                                                                                                                                                                      RecipeInstructions                                                                                                                                                                                                                                                                                                                                                                                                                                                 Recipe\n","153999  153999    235090  Harvest Corn Pudding           Corn        3  corn-kernels cornmeal mild-cheddar-cheese butter mild-green-chili green-onions sugar salt baking-soda cinnamon eggs buttermilk  <s> preheat oven 350 </s> <s> grease medium bake dish </s> <s> food processor blender puree 2 cup corn </s> <s> transfer puree corn remain kernel large mix bowl </s> <s> mix remain ingredient </s> <s> pour batter prepare dish </s> <s> bake pudding 50 55 minute till lightly brown firm </s> <s> serve warm </s>   corn-kernels cornmeal mild-cheddar-cheese butter mild-green-chili green-onions sugar salt baking-soda cinnamon eggs buttermilk <s> preheat oven 350 </s> <s> grease medium bake dish </s> <s> food processor blender puree 2 cup corn </s> <s> transfer puree corn remain kernel large mix bowl </s> <s> mix remain ingredient </s> <s> pour batter prepare dish </s> <s> bake pudding 50 55 minute till lightly brown firm </s> <s> serve warm </s> "],"text/html":["\n","  <div id=\"df-c0dbe29c-f767-4d48-88cd-959e6f00a972\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>153999</th>\n","      <td>153999</td>\n","      <td>235090</td>\n","      <td>Harvest Corn Pudding</td>\n","      <td>Corn</td>\n","      <td>3</td>\n","      <td>corn-kernels cornmeal mild-cheddar-cheese butter mild-green-chili green-onions sugar salt baking-soda cinnamon eggs buttermilk</td>\n","      <td>&lt;s&gt; preheat oven 350 &lt;/s&gt; &lt;s&gt; grease medium bake dish &lt;/s&gt; &lt;s&gt; food processor blender puree 2 cup corn &lt;/s&gt; &lt;s&gt; transfer puree corn remain kernel large mix bowl &lt;/s&gt; &lt;s&gt; mix remain ingredient &lt;/s&gt; &lt;s&gt; pour batter prepare dish &lt;/s&gt; &lt;s&gt; bake pudding 50 55 minute till lightly brown firm &lt;/s&gt; &lt;s&gt; serve warm &lt;/s&gt;</td>\n","      <td>corn-kernels cornmeal mild-cheddar-cheese butter mild-green-chili green-onions sugar salt baking-soda cinnamon eggs buttermilk &lt;s&gt; preheat oven 350 &lt;/s&gt; &lt;s&gt; grease medium bake dish &lt;/s&gt; &lt;s&gt; food processor blender puree 2 cup corn &lt;/s&gt; &lt;s&gt; transfer puree corn remain kernel large mix bowl &lt;/s&gt; &lt;s&gt; mix remain ingredient &lt;/s&gt; &lt;s&gt; pour batter prepare dish &lt;/s&gt; &lt;s&gt; bake pudding 50 55 minute till lightly brown firm &lt;/s&gt; &lt;s&gt; serve warm &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c0dbe29c-f767-4d48-88cd-959e6f00a972')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c0dbe29c-f767-4d48-88cd-959e6f00a972 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c0dbe29c-f767-4d48-88cd-959e6f00a972');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  255976\n","Similarity:  0.6549301743507385\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["         index  RecipeId                     Name RecipeCategory RatingId                                                        RecipeIngredientParts                                                                                                                                                                                                                                                                                                                                                                                                                                         RecipeInstructions  \\\n","255976  255976    467390  Blueberry Frozen Yogurt        Dessert        5  fresh-blueberries orange-juice-and-rind-of maple-syrup plain-low-fat-yogurt  <s> place blueberry orange rind juice food processor blender process puree </s> <s> strain sieve bowl pitcher </s> <s> stir maple syrup yogurt together large mix bowl fold fruit puree </s> <s> churn mixture ice cream machine follow manufacturer instruction freeze 5 6 hour </s> <s> ice cream machine transfer mixture freezerproof container freeze 2 hour </s> <s> remove freezer turn bowl beat smooth </s> <s> return freezer freeze firm </s>    \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Recipe  \n","255976  fresh-blueberries orange-juice-and-rind-of maple-syrup plain-low-fat-yogurt <s> place blueberry orange rind juice food processor blender process puree </s> <s> strain sieve bowl pitcher </s> <s> stir maple syrup yogurt together large mix bowl fold fruit puree </s> <s> churn mixture ice cream machine follow manufacturer instruction freeze 5 6 hour </s> <s> ice cream machine transfer mixture freezerproof container freeze 2 hour </s> <s> remove freezer turn bowl beat smooth </s> <s> return freezer freeze firm </s>   "],"text/html":["\n","  <div id=\"df-cd47420e-2fe1-438e-8a6d-00267d3c2f79\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>255976</th>\n","      <td>255976</td>\n","      <td>467390</td>\n","      <td>Blueberry Frozen Yogurt</td>\n","      <td>Dessert</td>\n","      <td>5</td>\n","      <td>fresh-blueberries orange-juice-and-rind-of maple-syrup plain-low-fat-yogurt</td>\n","      <td>&lt;s&gt; place blueberry orange rind juice food processor blender process puree &lt;/s&gt; &lt;s&gt; strain sieve bowl pitcher &lt;/s&gt; &lt;s&gt; stir maple syrup yogurt together large mix bowl fold fruit puree &lt;/s&gt; &lt;s&gt; churn mixture ice cream machine follow manufacturer instruction freeze 5 6 hour &lt;/s&gt; &lt;s&gt; ice cream machine transfer mixture freezerproof container freeze 2 hour &lt;/s&gt; &lt;s&gt; remove freezer turn bowl beat smooth &lt;/s&gt; &lt;s&gt; return freezer freeze firm &lt;/s&gt;</td>\n","      <td>fresh-blueberries orange-juice-and-rind-of maple-syrup plain-low-fat-yogurt &lt;s&gt; place blueberry orange rind juice food processor blender process puree &lt;/s&gt; &lt;s&gt; strain sieve bowl pitcher &lt;/s&gt; &lt;s&gt; stir maple syrup yogurt together large mix bowl fold fruit puree &lt;/s&gt; &lt;s&gt; churn mixture ice cream machine follow manufacturer instruction freeze 5 6 hour &lt;/s&gt; &lt;s&gt; ice cream machine transfer mixture freezerproof container freeze 2 hour &lt;/s&gt; &lt;s&gt; remove freezer turn bowl beat smooth &lt;/s&gt; &lt;s&gt; return freezer freeze firm &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cd47420e-2fe1-438e-8a6d-00267d3c2f79')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-cd47420e-2fe1-438e-8a6d-00267d3c2f79 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-cd47420e-2fe1-438e-8a6d-00267d3c2f79');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  253521\n","Similarity:  0.6360390782356262\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["         index  RecipeId                  Name   RecipeCategory RatingId                          RecipeIngredientParts                                                                                          RecipeInstructions                                                                                                                                                    Recipe\n","253521  253521    459463  Homemade Fudgesicles  Frozen Desserts        5  sweetened-condensed-milk milk vanilla-extract  <s> mix together ingredient smooth </s> <s> pour ice pop mold freeze solid least 4 hour unmold serve </s>   sweetened-condensed-milk milk vanilla-extract <s> mix together ingredient smooth </s> <s> pour ice pop mold freeze solid least 4 hour unmold serve </s> "],"text/html":["\n","  <div id=\"df-a08b99d1-1f98-4455-a1c9-e6a0a5f04713\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>253521</th>\n","      <td>253521</td>\n","      <td>459463</td>\n","      <td>Homemade Fudgesicles</td>\n","      <td>Frozen Desserts</td>\n","      <td>5</td>\n","      <td>sweetened-condensed-milk milk vanilla-extract</td>\n","      <td>&lt;s&gt; mix together ingredient smooth &lt;/s&gt; &lt;s&gt; pour ice pop mold freeze solid least 4 hour unmold serve &lt;/s&gt;</td>\n","      <td>sweetened-condensed-milk milk vanilla-extract &lt;s&gt; mix together ingredient smooth &lt;/s&gt; &lt;s&gt; pour ice pop mold freeze solid least 4 hour unmold serve &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a08b99d1-1f98-4455-a1c9-e6a0a5f04713')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a08b99d1-1f98-4455-a1c9-e6a0a5f04713 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a08b99d1-1f98-4455-a1c9-e6a0a5f04713');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  229364\n","Similarity:  0.6349404454231262\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["         index  RecipeId                                                      Name   RecipeCategory RatingId                                                       RecipeIngredientParts                                                                                                                                   RecipeInstructions                                                                                                                                                                                                                          Recipe\n","229364  229364    389959  Blueberry Sour Cream Ice Cream (Low Fat, No Added Sugar)  Frozen Desserts        5  fresh-blueberries stevia-powder lemon-juice reduced-fat-sour-cream berries  <s> puree blueberry food processor </s> <s> blend ingredient chill 2 4 hour </s> <s> freeze ice cream machine accord manufacturer instruction </s>   fresh-blueberries stevia-powder lemon-juice reduced-fat-sour-cream berries <s> puree blueberry food processor </s> <s> blend ingredient chill 2 4 hour </s> <s> freeze ice cream machine accord manufacturer instruction </s> "],"text/html":["\n","  <div id=\"df-be29d80c-1638-4a58-93b2-fcf5678d5a89\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>229364</th>\n","      <td>229364</td>\n","      <td>389959</td>\n","      <td>Blueberry Sour Cream Ice Cream (Low Fat, No Added Sugar)</td>\n","      <td>Frozen Desserts</td>\n","      <td>5</td>\n","      <td>fresh-blueberries stevia-powder lemon-juice reduced-fat-sour-cream berries</td>\n","      <td>&lt;s&gt; puree blueberry food processor &lt;/s&gt; &lt;s&gt; blend ingredient chill 2 4 hour &lt;/s&gt; &lt;s&gt; freeze ice cream machine accord manufacturer instruction &lt;/s&gt;</td>\n","      <td>fresh-blueberries stevia-powder lemon-juice reduced-fat-sour-cream berries &lt;s&gt; puree blueberry food processor &lt;/s&gt; &lt;s&gt; blend ingredient chill 2 4 hour &lt;/s&gt; &lt;s&gt; freeze ice cream machine accord manufacturer instruction &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-be29d80c-1638-4a58-93b2-fcf5678d5a89')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-be29d80c-1638-4a58-93b2-fcf5678d5a89 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-be29d80c-1638-4a58-93b2-fcf5678d5a89');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  26358\n","Similarity:  0.6339403390884399\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["       index  RecipeId                     Name RecipeCategory RatingId                   RecipeIngredientParts                                                                                                                                       RecipeInstructions                                                                                                                                                                                          Recipe\n","26358  26358     37654  Banana Pineapple Freeze        Dessert        5  baas fresh-lemon-juice ground-cinnamon  <s> combine ingredient food processor process smooth creamy </s> <s> pour mixture 9 9 2 inch bake dish freeze overnight firm </s> <s> serve chill </s>   baas fresh-lemon-juice ground-cinnamon <s> combine ingredient food processor process smooth creamy </s> <s> pour mixture 9 9 2 inch bake dish freeze overnight firm </s> <s> serve chill </s> "],"text/html":["\n","  <div id=\"df-c7d68d78-e2ac-4bf3-890f-c7bb01fe7724\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>26358</th>\n","      <td>26358</td>\n","      <td>37654</td>\n","      <td>Banana Pineapple Freeze</td>\n","      <td>Dessert</td>\n","      <td>5</td>\n","      <td>baas fresh-lemon-juice ground-cinnamon</td>\n","      <td>&lt;s&gt; combine ingredient food processor process smooth creamy &lt;/s&gt; &lt;s&gt; pour mixture 9 9 2 inch bake dish freeze overnight firm &lt;/s&gt; &lt;s&gt; serve chill &lt;/s&gt;</td>\n","      <td>baas fresh-lemon-juice ground-cinnamon &lt;s&gt; combine ingredient food processor process smooth creamy &lt;/s&gt; &lt;s&gt; pour mixture 9 9 2 inch bake dish freeze overnight firm &lt;/s&gt; &lt;s&gt; serve chill &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c7d68d78-e2ac-4bf3-890f-c7bb01fe7724')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c7d68d78-e2ac-4bf3-890f-c7bb01fe7724 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c7d68d78-e2ac-4bf3-890f-c7bb01fe7724');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["index:  246777\n","Similarity:  0.6321957111358643\n","Recipe: \n"]},{"output_type":"display_data","data":{"text/plain":["         index  RecipeId                   Name RecipeCategory RatingId                                              RecipeIngredientParts                                                                                                                                                                                                                                                                                                                                                                                               RecipeInstructions  \\\n","246777  246777    438582  Dairy Queen Ice Cream      Ice Cream        5  unflavored-gelatin cold-water milk sugar vanilla salt heavy-cream  <s> sprinkle gelatin water let stand 5 minute </s> <s> meanwhile heat milk almost simmer medium low heat </s> <s> remove heat </s> <s> stir sugar vanilla sugar wire whisk sugar completely dissolve least 2 minute </s> <s> stir gelatin mixture let cool </s> <s> stir cream </s> <s> cover refrigerate 6 hour </s> <s> transfer ice cream maker process accord manufacturer direction 20 minute creamy </s>    \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Recipe  \n","246777  unflavored-gelatin cold-water milk sugar vanilla salt heavy-cream <s> sprinkle gelatin water let stand 5 minute </s> <s> meanwhile heat milk almost simmer medium low heat </s> <s> remove heat </s> <s> stir sugar vanilla sugar wire whisk sugar completely dissolve least 2 minute </s> <s> stir gelatin mixture let cool </s> <s> stir cream </s> <s> cover refrigerate 6 hour </s> <s> transfer ice cream maker process accord manufacturer direction 20 minute creamy </s>   "],"text/html":["\n","  <div id=\"df-dc7294cf-6b06-4e47-ae3f-4337f894ff4b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>RecipeId</th>\n","      <th>Name</th>\n","      <th>RecipeCategory</th>\n","      <th>RatingId</th>\n","      <th>RecipeIngredientParts</th>\n","      <th>RecipeInstructions</th>\n","      <th>Recipe</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>246777</th>\n","      <td>246777</td>\n","      <td>438582</td>\n","      <td>Dairy Queen Ice Cream</td>\n","      <td>Ice Cream</td>\n","      <td>5</td>\n","      <td>unflavored-gelatin cold-water milk sugar vanilla salt heavy-cream</td>\n","      <td>&lt;s&gt; sprinkle gelatin water let stand 5 minute &lt;/s&gt; &lt;s&gt; meanwhile heat milk almost simmer medium low heat &lt;/s&gt; &lt;s&gt; remove heat &lt;/s&gt; &lt;s&gt; stir sugar vanilla sugar wire whisk sugar completely dissolve least 2 minute &lt;/s&gt; &lt;s&gt; stir gelatin mixture let cool &lt;/s&gt; &lt;s&gt; stir cream &lt;/s&gt; &lt;s&gt; cover refrigerate 6 hour &lt;/s&gt; &lt;s&gt; transfer ice cream maker process accord manufacturer direction 20 minute creamy &lt;/s&gt;</td>\n","      <td>unflavored-gelatin cold-water milk sugar vanilla salt heavy-cream &lt;s&gt; sprinkle gelatin water let stand 5 minute &lt;/s&gt; &lt;s&gt; meanwhile heat milk almost simmer medium low heat &lt;/s&gt; &lt;s&gt; remove heat &lt;/s&gt; &lt;s&gt; stir sugar vanilla sugar wire whisk sugar completely dissolve least 2 minute &lt;/s&gt; &lt;s&gt; stir gelatin mixture let cool &lt;/s&gt; &lt;s&gt; stir cream &lt;/s&gt; &lt;s&gt; cover refrigerate 6 hour &lt;/s&gt; &lt;s&gt; transfer ice cream maker process accord manufacturer direction 20 minute creamy &lt;/s&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dc7294cf-6b06-4e47-ae3f-4337f894ff4b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dc7294cf-6b06-4e47-ae3f-4337f894ff4b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dc7294cf-6b06-4e47-ae3f-4337f894ff4b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"markdown","source":["#### **Visualizing the doc2vec embedding** \n","This was done using tensorboard projector\n","\n","\n","After projecting the doc2vec embedding model trained on the recipes, we observed some clusters within the recipes. \n","\n","**The screenshots and the videos of the visualization is in the output folder**\n","\n","---\n","\n","\n","\n","\n"],"metadata":{"id":"nnOSXwTYOWId"}},{"cell_type":"code","source":["# Save in a word2vec format, needed to convert to tensorflow format\n","doc2vec_model.save_word2vec_format('/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tensor.w2v', doctag_vec=True, word_vec=False)\n"],"metadata":{"id":"Wlsc2HRtHEI4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Convert to tsv format to use tensorboard projector\n","!python3 -m gensim.scripts.word2vec2tensor -i /content/gdrive/My\\ Drive/Colab\\ Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tensor.w2v -o /content/gdrive/My\\ Drive/Colab\\ Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tf.tsv"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"R_HpqimbH5j8","executionInfo":{"status":"ok","timestamp":1651435005686,"user_tz":240,"elapsed":19935,"user":{"displayName":"Lakshyana K C","userId":"03123992237616606989"}},"outputId":"4c4bcdbb-43dc-4de8-f882-9f334eb0c813"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["2022-05-01 19:56:26,926 - word2vec2tensor - INFO - running /usr/local/lib/python3.7/dist-packages/gensim/scripts/word2vec2tensor.py -i /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tensor.w2v -o /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tf.tsv\n","2022-05-01 19:56:26,927 - utils_any2vec - INFO - loading projection weights from /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tensor.w2v\n","2022-05-01 19:56:34,954 - utils_any2vec - INFO - loaded (269294, 50) matrix from /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tensor.w2v\n","2022-05-01 19:56:45,274 - word2vec2tensor - INFO - 2D tensor file saved to /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tf.tsv_tensor.tsv\n","2022-05-01 19:56:45,275 - word2vec2tensor - INFO - Tensor metadata file saved to /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tf.tsv_metadata.tsv\n","2022-05-01 19:56:45,322 - word2vec2tensor - INFO - finished running word2vec2tensor.py\n"]}]},{"cell_type":"code","source":["### Update the metadata in by adding recipe information\n","with open(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/doc2vec2_t_tf.tsv_metadata.tsv\",'w') as w:\n","    w.write('Name\\tRatingId\\tIngredients\\tRecipe\\n')\n","    for i,j,k,l in zip(text_feature['RecipeCategory']+\": \" +text_feature['Name']+\" (\"+text_feature['RatingId'].astype(str)+\")\",\n","                       text_feature['RatingId'], text_feature[\"RecipeIngredientParts\"], text_feature[\"RecipeInstructions\"]):\n","        w.write(\"%s\\t%s\\t%s\\t%s\\n\" % (i,j,k,l))"],"metadata":{"id":"u05UWWxOIjrg"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ix2On6zat8G2"},"source":["# **Step 3: Feedforward Neural Language Model**\n","--------------------------"]},{"cell_type":"markdown","metadata":{"id":"FHcTJeqwejcr"},"source":["### DATA PREPROCESSING\n","Deep Neural Networks input layers make use of input variables to feed the network for training the model. But in this task (experiment), we're dealing with words text. How do we represent these words in order to feed our model?\n","\n","In our experiment, we used densed representation of those text (comments) and their semanticity together. The advantage of using this approach is the best way for fitting neural networks onto a text data (as in our case), as well as less memory usage compared to other sparse representation approaches.\n","\n","\n","#### Word Embedding\n","Two ways to feed embeddings to neural networks:\n","   * Using your own word embeddings by training\n","   * Using pre-trained embedding (e.g Word2vec, lad2vec, Glove etc)\n","   \n"]},{"cell_type":"markdown","source":["#### **Format the dataset: X train, X test, Y train, and Y test**"],"metadata":{"id":"TyeYBndeEQOI"}},{"cell_type":"code","source":["##Update the labels to be values between 0 - 3 to represent the four labels 2, 3,4,5. \n","\n","def reduceLabelIndex(label):\n","  return label - 2\n","\n","X_train = training_data['Recipe']\n","X_train_indices = training_data['index'].to_numpy().reshape(len(training_data['index']),1)\n","y_train = training_data['RatingId'].apply(reduceLabelIndex).to_numpy()\n","# .reshape(len(training_data['index']),1)\n","X_test = training_data['Recipe']\n","X_test_indices = testing_data['index'].to_numpy().reshape(len(testing_data['index']),1)\n","y_test = testing_data['RatingId'].apply(reduceLabelIndex).to_numpy()\n","# .reshape(len(testing_data['index']),1)\n","\n","print(\"Training Data Indices\",X_train_indices[:5])\n","print(\"Training Data Labels\",y_train[:5])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TEdTHQdpmO0A","executionInfo":{"status":"ok","timestamp":1651618045876,"user_tz":240,"elapsed":154,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"06357f53-423b-4ee3-f9fd-7c2605825d86"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Training Data Indices [[235422]\n"," [ 16937]\n"," [123315]\n"," [ 35989]\n"," [252151]]\n","Training Data Labels [3 3 2 3 3]\n"]}]},{"cell_type":"markdown","source":["#### **Prepare Vectorized Dataset**"],"metadata":{"id":"WKsoFEQrF6Yy"}},{"cell_type":"code","source":["##########################\n","###     SETTINGS       ###\n","##########################\n","\n","# Hyperparameters\n","learning_rate = 0.05\n","batch_size = 300\n","num_epochs = 500\n","\n","# Architecture\n","NUM_CLASSES = 4  #(1-2,3,4,5)"],"metadata":{"id":"In1k6vgRF6Yy"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["#### **Get the Doc2vec Embedding Matrix to create the embedding layer**"],"metadata":{"id":"C4ycBCP4Ebpm"}},{"cell_type":"code","source":["### creating the embedding matrix\n","import tensorflow as tf\n","from keras.layers import Input\n","from keras.initializers import Constant\n","from tensorflow.keras import Sequential\n","from tensorflow.keras.layers import Dense, Embedding, Dropout\n","\n","\n","EMBEDDINGS_SIZE = 50 \n","\n","df = text_feature\n","DATA_SIZE = len(df)\n","\n","embedding_matrix = np.zeros((len(df)+1, EMBEDDINGS_SIZE))\n","for i, row in df.iterrows():\n","    embedding = doc2vec_model.docvecs[row['index']]\n","    embedding_matrix[i+1] = embedding\n","\n","\n","### input with the id of document\n","doc_input = Input(shape=(1,),dtype='int16', name='doc_input')\n","\n","### Now create an embedding layer intialized with the matrix created earlier to later feed into the model\n","embedding_layer = Embedding(output_dim=EMBEDDINGS_SIZE, input_dim= DATA_SIZE+ 1,embeddings_initializer = Constant(embedding_matrix), input_length=1, trainable=False)"],"metadata":{"id":"SelSlxCXSQYh"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["#### **Setup Ordinal Classification Model**"],"metadata":{"id":"57kKalqDFsK7"}},{"cell_type":"markdown","source":["**Evaluation Metrics for Test Dataset**"],"metadata":{"id":"F2Sv_P9AQbdF"}},{"cell_type":"code","source":["def recall_m(y_true, y_pred):\n","    true_positives = K.sum(K.round(K.clip(y_true * y_pred, 0, 1)))\n","    possible_positives = K.sum(K.round(K.clip(y_true, 0, 1)))\n","    recall = true_positives / (possible_positives + K.epsilon())\n","    return recall\n","\n","def precision_m(y_true, y_pred):\n","    true_positives = K.sum(K.round(K.clip(y_true * y_pred, 0, 1)))\n","    predicted_positives = K.sum(K.round(K.clip(y_pred, 0, 1)))\n","    precision = true_positives / (predicted_positives + K.epsilon())\n","    return precision\n","\n","def f1_m(y_true, y_pred):\n","    precision = precision_m(y_true, y_pred)\n","    recall = recall_m(y_true, y_pred)\n","    return 2*((precision*recall)/(precision+recall+K.epsilon()))  \n"],"metadata":{"id":"xvRxVZMwDShv"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**Create a Ordinal Classification Model**"],"metadata":{"id":"5Yvdw0JfQj8s"}},{"cell_type":"code","source":["### creating the embedding matrix\n","import tensorflow as tf\n","from keras.layers import Input\n","from keras.initializers import Constant\n","from tensorflow.keras import Sequential\n","from tensorflow.keras.layers import Dense, Embedding, Dropout\n","from keras.layers import Reshape\n","from keras import backend as K\n","\n","\n","\n","def create_model():\n","  model = Sequential([\n","                    # Embedding layer\n","                    embedding_layer,\n","                    # Reshape \n","                    Reshape([EMBEDDINGS_SIZE]),\n","                    # Dense Layer\n","                    Dense(50, activation='relu'),\n","                    # Dropout\n","                    Dropout(0.2),\n","                    # Dense Layer\n","                    Dense(16, activation='relu'),\n","                    Dropout(0.1),\n","                    coral.CoralOrdinal(NUM_CLASSES),\n","                    # Dense(6, activation=tf.nn.softmax)\n","                    ])\n","  \n","  model.compile(optimizer = tf.keras.optimizers.Adam(learning_rate = learning_rate),\n","              loss = coral.OrdinalCrossEntropy(num_classes = NUM_CLASSES),\n","              metrics = [coral.MeanAbsoluteErrorLabels()\n","                        #  ,f1_m,\n","                        #  precision_m,\n","                        #  recall_m\n","                         ])\n","  \n","  return model\n","\n","model = create_model()\n","print(model.summary()) "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SAWCuJH-8zJl","executionInfo":{"status":"ok","timestamp":1651618109413,"user_tz":240,"elapsed":548,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"5966b363-07db-440a-bdde-38156e4085a0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," embedding (Embedding)       (None, 1, 50)             13464750  \n","                                                                 \n"," reshape (Reshape)           (None, 50)                0         \n","                                                                 \n"," dense (Dense)               (None, 50)                2550      \n","                                                                 \n"," dropout (Dropout)           (None, 50)                0         \n","                                                                 \n"," dense_1 (Dense)             (None, 16)                816       \n","                                                                 \n"," dropout_1 (Dropout)         (None, 16)                0         \n","                                                                 \n"," coral_ordinal (CoralOrdinal  (None, 3)                19        \n"," )                                                               \n","                                                                 \n","=================================================================\n","Total params: 13,468,135\n","Trainable params: 3,385\n","Non-trainable params: 13,464,750\n","_________________________________________________________________\n","None\n"]}]},{"cell_type":"markdown","source":["**Prepare Tensor Datasets for Batch Processing: Training, Test and Validation Datasets**"],"metadata":{"id":"60QJ-5IMQx00"}},{"cell_type":"code","source":["### Training Data\n","dataset = tf.data.Dataset.from_tensor_slices(\n","  (tf.cast(np.array(X_train_indices)[..., tf.newaxis], tf.float32),\n","   tf.cast(np.array(y_train), tf.int64)))\n","\n","dataset = dataset.batch(batch_size)\n","\n","\n","## Testing and validation datasets\n","\n","## Get 80/20 split\n","testing_data_size = len(testing_data)\n","testing_split = int(np.floor(0.80*testing_data_size))\n","validatation_split = int(np.floor(0.20*testing_data_size))\n","\n","test_dataset = tf.data.Dataset.from_tensor_slices(\n","  (tf.cast(np.array(X_test_indices[:testing_split])[..., tf.newaxis], tf.float32),\n","   tf.cast(np.array(y_test[:testing_split]), tf.int64)))\n","\n","test_dataset = test_dataset.shuffle(50).batch(batch_size)\n","# without shuffling the test dataset.\n","# test_dataset = test_dataset.batch(batch_size)\n","\n","\n","val_dataset = tf.data.Dataset.from_tensor_slices(\n","  (tf.cast(np.array(X_test_indices[testing_split: testing_split+validatation_split])[..., tf.newaxis], tf.float32),\n","   tf.cast(np.array(y_test[testing_split: testing_split+validatation_split]), tf.int64)))\n","val_dataset = val_dataset.shuffle(50).batch(batch_size)\n"],"metadata":{"id":"SXFWs2kwm82M"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["training_data['RatingId']"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tEKsjXXccN0o","executionInfo":{"status":"ok","timestamp":1651596826537,"user_tz":240,"elapsed":130,"user":{"displayName":"Lakshyana K C","userId":"03123992237616606989"}},"outputId":"3ed2f776-0a2e-4b59-88f3-c2cf3865827b"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0         5\n","1         5\n","2         4\n","3         5\n","4         5\n","         ..\n","201965    4\n","201966    4\n","201967    5\n","201968    5\n","201969    4\n","Name: RatingId, Length: 201970, dtype: category\n","Categories (4, int64): [2, 3, 4, 5]"]},"metadata":{},"execution_count":18}]},{"cell_type":"markdown","source":["**Balance the classes in the Imbalanced Dataset**"],"metadata":{"id":"0zYX9hB1RBSC"}},{"cell_type":"code","source":["from sklearn.utils.class_weight import compute_class_weight\n","\n","# Count samples per class\n","classes_two   = training_data[training_data['RatingId'] == 2]\n","classes_three = training_data[training_data['RatingId'] == 3]\n","classes_four  = training_data[training_data['RatingId'] == 4]\n","classes_five  = training_data[training_data['RatingId'] == 5]\n","\n","# Convert parts into NumPy arrays for weight computation\n","two_numpy = classes_two['RatingId'].to_numpy()\n","three_numpy = classes_three['RatingId'].to_numpy()\n","four_numpy = classes_four['RatingId'].to_numpy()\n","five_numpy = classes_five['RatingId'].to_numpy()\n","\n","all_together = np.concatenate((two_numpy, three_numpy, four_numpy, five_numpy))\n","unique_classes = np.unique(all_together)\n","\n","class_labels = np.array([0,1,2,3])\n","# Compute weights\n","class_weights = compute_class_weight(class_weight = \"balanced\", classes= np.unique(all_together), y= all_together)\n","class_weights = dict(zip(class_labels, class_weights))\n","\n","# weights = sklearn.utils.class_weight.compute_class_weight('balanced', unique_classes, all_together)\n","print(class_weights)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TamucFvzaucx","executionInfo":{"status":"ok","timestamp":1651618338158,"user_tz":240,"elapsed":163,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"9e55ede6-73ba-4a71-f8b4-777600c92242"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["{0: 14.951880367189814, 1: 5.128745556119858, 2: 0.8710709726391332, 3: 0.38608141793213135}\n"]}]},{"cell_type":"markdown","source":["**Model 1:**\n","\n","\n","---\n","\n","\n","Batch-size: 500, Epochs: 500, Learning Rate: 0.05\n","\n","\n","*Monitoring Validation Loss for Early Stopping*"],"metadata":{"id":"iPxmaicBRRNe"}},{"cell_type":"code","source":["%%time\n","from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint\n","\n","\n","checkpoint_path = \"/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Models/training/cp.ckpt\"\n","checkpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Models/\")\n","\n","\n","callbacks = [tf.keras.callbacks.EarlyStopping(\n","                        monitor='val_loss',\n","                        mode='min', \n","                        verbose=1, \n","                        patience = 50,\n","                        restore_best_weights = True),          \n","              ModelCheckpoint(filepath=checkpoint_path, monitor='val_loss', save_best_only=True, mode='min')]\n","\n","# callbacks = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_path,\n","#                                                  save_weights_only=True,\n","#                                                  verbose=1)\n","\n","history = model.fit(dataset, \n","                    epochs = num_epochs,\n","                    validation_data = val_dataset,\n","                    class_weight = class_weights,\n","                    use_multiprocessing=True,\n","                    callbacks=callbacks\n","                    )\n","\n","\n","## Save the history\n","np.save('/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Models/training/model_history.npy',history.history)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cRiLjRYneIzz","executionInfo":{"status":"ok","timestamp":1651552924401,"user_tz":240,"elapsed":672311,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"e8a7f916-e570-4815-be65-57c49efe354a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/500\n","400/404 [============================>.] - ETA: 0s - loss: 0.9821 - mean_absolute_error_labels: 0.4349 - f1_m: 1.4899 - precision_m: 0.9922 - recall_m: 2.9983INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp.ckpt/assets\n","404/404 [==============================] - 100s 247ms/step - loss: 0.9818 - mean_absolute_error_labels: 0.4348 - f1_m: 1.4898 - precision_m: 0.9921 - recall_m: 2.9983 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 2/500\n","397/404 [============================>.] - ETA: 0s - loss: 0.9822 - mean_absolute_error_labels: 0.4350 - f1_m: 1.4893 - precision_m: 0.9915 - recall_m: 2.9991INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp.ckpt/assets\n","404/404 [==============================] - 94s 233ms/step - loss: 0.9810 - mean_absolute_error_labels: 0.4347 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9991 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 3/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9810 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 4/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9810 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 5/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 6/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4347 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 7/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 8/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 9/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 10/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 11/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 12/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 13/500\n","400/404 [============================>.] - ETA: 0s - loss: 0.9812 - mean_absolute_error_labels: 0.4348 - f1_m: 1.4892 - precision_m: 0.9915 - recall_m: 2.9992INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp.ckpt/assets\n","404/404 [==============================] - 83s 206ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 14/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9810 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 15/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 16/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 17/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 18/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 19/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 20/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 21/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 22/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 23/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 24/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4347 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9991 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 25/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 26/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 27/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 28/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 29/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 30/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 31/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 32/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 33/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 34/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 35/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 36/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 37/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 38/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 39/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 40/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 41/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9822 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 42/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9816 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9991 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 43/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 44/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 45/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 46/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 47/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 48/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 49/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 50/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 51/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 52/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 53/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 54/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 55/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4347 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9991 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 56/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 57/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 58/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 59/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 60/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 61/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 62/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9809 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 63/500\n","399/404 [============================>.] - ETA: 0s - loss: 0.9819 - mean_absolute_error_labels: 0.4350 - f1_m: 1.4892 - precision_m: 0.9915 - recall_m: 2.9991Restoring model weights from the end of the best epoch: 13.\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9810 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4892 - precision_m: 0.9914 - recall_m: 2.9992 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4793 - val_precision_m: 0.9817 - val_recall_m: 3.0000\n","Epoch 63: early stopping\n","CPU times: user 6min 59s, sys: 1min 23s, total: 8min 23s\n","Wall time: 11min 11s\n"]}]},{"cell_type":"markdown","source":["**Evaluate Model 1**"],"metadata":{"id":"v6hm89Q9Ru1s"}},{"cell_type":"code","source":["from sklearn.metrics import precision_score, f1_score, classification_report\n","from sklearn.metrics import ConfusionMatrixDisplay\n","from sklearn.metrics import confusion_matrix\n","import matplotlib.pyplot as plt\n","import numpy as np\n","\n","from sklearn.metrics import mean_absolute_error\n","\n","\n","\n","### Update the label from 0-3 back to original ratings 2-5\n","def update_labels(label):\n","  return label+2\n","\n","\n","## Get the test dataset\n","test_dataset = tf.data.Dataset.from_tensor_slices(\n","  (tf.cast(np.array(X_test_indices)[..., tf.newaxis], tf.float32),\n","   tf.cast(np.array(y_test), tf.int64)))\n","\n","test_dataset = test_dataset.shuffle(50).batch(batch_size)\n","\n","checkpoint_path = \"/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Data/Models/classifiers/training/cp.ckpt\"\n","checkpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/\")\n","\n","## Create model instance\n","model = create_model()\n","\n","# Loads the weights\n","model.load_weights(checkpoint_path)\n","\n","## Evaluate the model on test dataset\n","model.evaluate(test_dataset)\n","\n","# Note that these are ordinal (cumulative) logits, not probabilities or regular logits.\n","ordinal_logits = model.predict(test_dataset)\n","\n","# Convert from logits to label probabilities. This is initially a tensorflow tensor.\n","tensor_probs = coral.ordinal_softmax(ordinal_logits)\n","\n","# Convert the tensor into a pandas dataframe.\n","probs_df = pd.DataFrame(tensor_probs.numpy())\n","\n","predictions = pd.DataFrame()\n","predictions[\"predicted_label\"]  = np.argmax(tensor_probs.numpy(), axis = 1)\n","predictions[\"true_label\"]       = y_test\n","\n","predictions[\"predicted_label\"]  = predictions[\"predicted_label\"].apply(update_labels)\n","predictions[\"true_label\"]       = predictions[\"true_label\"].apply(update_labels)\n","\n","\n","y_pred = predictions[\"predicted_label\"].to_numpy()\n","y_true = predictions[\"true_label\"].to_numpy()\n","labels =  ['Class 1-2', 'Class 3', 'Class 4', 'Class 5']\n","\n","cm = confusion_matrix(y_true, y_pred)\n","\n","disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=labels)\n","\n","disp.plot(cmap=plt.cm.Blues)\n","plt.show()\n","\n","\n","predictions = pd.DataFrame()\n","predictions[\"predicted_label\"]  = np.argmax(tensor_probs.numpy(), axis = 1)\n","predictions[\"true_label\"]       = y_test\n","\n","# y_pred = predictions[\"predicted_label\"].to_numpy()\n","# y_true = predictions[\"true_label\"].to_numpy()\n","\n","target_names = ['class 2', 'class 3', 'class 4','class 5']\n","print(\"\\n\\tMean Absolute Error: \",mean_absolute_error(y_true,y_pred),\"\\n\")\n","print(classification_report(y_true, y_pred, target_names=target_names))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":677},"id":"djjOLdGcRP-1","executionInfo":{"status":"ok","timestamp":1651594970043,"user_tz":240,"elapsed":5648,"user":{"displayName":"Lakshyana K C","userId":"03123992237616606989"}},"outputId":"f1dba68b-5a2e-49cb-e929-e79fd1e32438"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["225/225 [==============================] - 2s 4ms/step - loss: 85.7614 - mean_absolute_error_labels: 0.4696 - f1_m: 1.4688 - precision_m: 0.9846 - recall_m: 2.8899\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}},{"output_type":"stream","name":"stdout","text":["\n","\tMean Absolute Error:  0.46794605192799 \n","\n","              precision    recall  f1-score   support\n","\n","     class 2       0.00      0.00      0.00      1098\n","     class 3       0.06      0.01      0.01      3299\n","     class 4       0.29      0.10      0.14     19193\n","     class 5       0.65      0.90      0.75     43734\n","\n","    accuracy                           0.61     67324\n","   macro avg       0.25      0.25      0.23     67324\n","weighted avg       0.51      0.61      0.53     67324\n","\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}]},{"cell_type":"code","source":["# xx = np.array([1,2,3])\n","# width = 0.15\n","# gb_prf = np.array([0.83, 0.83, 0.83])\n","# ax = plt.subplot(111)\n","# ax.bar(xx - width, height=np.array(nb_prf), width=width, color='b', align='center', label='NB', tick_label=['Precision', 'Recall', 'f1'])\n","# ax.bar(xx ,height=np.array(log_prf), width=width, color='g', align='center', label='Log_Reg')\n","# ax.bar(xx + width, height=np.array(svm_prf), width=width, color='r', align='center', label='SVM')\n","# ax.bar(xx + 2*width, height=np.array(rf_prf), width=width, color='y', align='center', label='Random Forest')\n","\n","# plt.xlabel('Classification Metrics')\n","# plt.ylabel('Scores')\n","# plt.legend(loc='lower right')\n","# plt.show()"],"metadata":{"id":"mw3enwBVuEOf"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**Model 2**\n","\n","\n","---\n","\n","\n","learning_rate = 0.01\n","batch_size = 200\n","num_epochs = 500"],"metadata":{"id":"uWPJ2jB9vksP"}},{"cell_type":"code","source":["%%time\n","from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint\n","\n","\n","# Hyperparameters\n","learning_rate = 0.1\n","batch_size = 500\n","num_epochs = 100\n","\n","\n","checkpoint_path = \"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt\"\n","checkpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/\")\n","\n","## Create model instance\n","model = create_model()\n","\n","# Loads the weights\n","model.load_weights(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/ordinal_classifier_main\")\n","\n","callbacks = [tf.keras.callbacks.EarlyStopping(\n","                        monitor='mean_absolute_error_labels',\n","                        # mode='min', \n","                        verbose=1, \n","                        patience = 50,\n","                        restore_best_weights = False\n","                        ),          \n","              ModelCheckpoint(filepath=checkpoint_path, \n","                              monitor='mean_absolute_error_labels', \n","\n","                              min_delta = 0.001,\n","                              # save_best_only=True\n","                              # ,mode='min'\n","                              )]\n","\n","history = model.fit(dataset, \n","                    epochs = num_epochs,\n","                    validation_data = val_dataset,\n","                    # validation_split = 0.2,\n","                    class_weight = class_weights,\n","                    use_multiprocessing=True,\n","                    callbacks=callbacks\n","                    )\n","\n","\n","## Save the history\n","np.save('/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/model_history_one_metric_mae.npy',history.history)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ubJnIdVsyAYb","outputId":"d0e827ee-3be1-4efb-a2f7-a3ff30757e90","executionInfo":{"status":"ok","timestamp":1651623589380,"user_tz":240,"elapsed":1465165,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","666/674 [============================>.] - ETA: 0s - loss: 1.1791 - mean_absolute_error_labels: 0.4648INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 81s 120ms/step - loss: 1.1767 - mean_absolute_error_labels: 0.4642 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4416\n","Epoch 2/100\n","664/674 [============================>.] - ETA: 0s - loss: 0.9849 - mean_absolute_error_labels: 0.4350INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 85s 126ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4347 - val_loss: 0.9990 - val_mean_absolute_error_labels: 0.4415\n","Epoch 3/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 103ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9991 - val_mean_absolute_error_labels: 0.4416\n","Epoch 4/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 90s 134ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9992 - val_mean_absolute_error_labels: 0.4414\n","Epoch 5/100\n","665/674 [============================>.] - ETA: 0s - loss: 0.9850 - mean_absolute_error_labels: 0.4350INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 104ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9993 - val_mean_absolute_error_labels: 0.4415\n","Epoch 6/100\n","666/674 [============================>.] - ETA: 0s - loss: 0.9844 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 74s 110ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 7/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 76s 113ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 8/100\n","666/674 [============================>.] - ETA: 0s - loss: 0.9844 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 84s 124ms/step - loss: 0.9842 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 9/100\n","665/674 [============================>.] - ETA: 0s - loss: 0.9850 - mean_absolute_error_labels: 0.4350INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 73s 108ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 10/100\n","674/674 [==============================] - ETA: 0s - loss: 0.9842 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 106ms/step - loss: 0.9842 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 11/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 105ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 12/100\n","673/674 [============================>.] - ETA: 0s - loss: 0.9843 - mean_absolute_error_labels: 0.4347INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 72s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 13/100\n","668/674 [============================>.] - ETA: 0s - loss: 0.9850 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 104ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4414\n","Epoch 14/100\n","664/674 [============================>.] - ETA: 0s - loss: 0.9851 - mean_absolute_error_labels: 0.4350INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 73s 109ms/step - loss: 0.9843 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 15/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 76s 113ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 16/100\n","666/674 [============================>.] - ETA: 0s - loss: 0.9844 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 74s 109ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 17/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9854 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 74s 110ms/step - loss: 0.9848 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 18/100\n","667/674 [============================>.] - ETA: 0s - loss: 0.9854 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 75s 111ms/step - loss: 0.9852 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9995 - val_mean_absolute_error_labels: 0.4416\n","Epoch 19/100\n","674/674 [==============================] - ETA: 0s - loss: 0.9843 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 106ms/step - loss: 0.9843 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 20/100\n","664/674 [============================>.] - ETA: 0s - loss: 0.9851 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 105ms/step - loss: 0.9843 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 21/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 72s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4416\n","Epoch 22/100\n","665/674 [============================>.] - ETA: 0s - loss: 0.9850 - mean_absolute_error_labels: 0.4350INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 75s 111ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 23/100\n","674/674 [==============================] - ETA: 0s - loss: 0.9841 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 105ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 24/100\n","666/674 [============================>.] - ETA: 0s - loss: 0.9844 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 73s 109ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 25/100\n","670/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 105ms/step - loss: 0.9842 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 26/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 74s 109ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4416\n","Epoch 27/100\n","669/674 [============================>.] - ETA: 0s - loss: 0.9855 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 73s 108ms/step - loss: 0.9848 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 28/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 74s 110ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 29/100\n","666/674 [============================>.] - ETA: 0s - loss: 0.9844 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 72s 108ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 30/100\n","674/674 [==============================] - ETA: 0s - loss: 0.9841 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 75s 111ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 31/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 32/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 75s 112ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 33/100\n","667/674 [============================>.] - ETA: 0s - loss: 0.9843 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 105ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 34/100\n","669/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 104ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 35/100\n","667/674 [============================>.] - ETA: 0s - loss: 0.9843 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 36/100\n","669/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 72s 107ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 37/100\n","674/674 [==============================] - ETA: 0s - loss: 0.9841 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 78s 116ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 38/100\n","670/674 [============================>.] - ETA: 0s - loss: 0.9847 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 73s 109ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4416\n","Epoch 39/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 40/100\n","670/674 [============================>.] - ETA: 0s - loss: 0.9847 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 104ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 41/100\n","667/674 [============================>.] - ETA: 0s - loss: 0.9843 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 104ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 42/100\n","666/674 [============================>.] - ETA: 0s - loss: 0.9844 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 73s 108ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 43/100\n","674/674 [==============================] - ETA: 0s - loss: 0.9841 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 104ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 44/100\n","662/674 [============================>.] - ETA: 0s - loss: 0.9853 - mean_absolute_error_labels: 0.4350INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 73s 109ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4416\n","Epoch 45/100\n","666/674 [============================>.] - ETA: 0s - loss: 0.9844 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 75s 112ms/step - loss: 0.9842 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 46/100\n","667/674 [============================>.] - ETA: 0s - loss: 0.9843 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 103ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 47/100\n","669/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 69s 102ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4414\n","Epoch 48/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 69s 103ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 49/100\n","673/674 [============================>.] - ETA: 0s - loss: 0.9843 - mean_absolute_error_labels: 0.4347INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 50/100\n","662/674 [============================>.] - ETA: 0s - loss: 0.9854 - mean_absolute_error_labels: 0.4350INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 69s 103ms/step - loss: 0.9842 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 51/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 72s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4416\n","Epoch 52/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 69s 103ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 53/100\n","672/674 [============================>.] - ETA: 0s - loss: 0.9846 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 105ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 54/100\n","668/674 [============================>.] - ETA: 0s - loss: 0.9850 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 106ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 55/100\n","668/674 [============================>.] - ETA: 0s - loss: 0.9851 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 69s 103ms/step - loss: 0.9842 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 56/100\n","669/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4349INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 68s 101ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 57/100\n","671/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 103ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 58/100\n","674/674 [==============================] - ETA: 0s - loss: 0.9841 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 71s 105ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 59/100\n","669/674 [============================>.] - ETA: 0s - loss: 0.9848 - mean_absolute_error_labels: 0.4349Restoring model weights from the end of the best epoch: 9.\n","INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_one_metric_mae.ckpt/assets\n","674/674 [==============================] - 70s 105ms/step - loss: 0.9841 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9994 - val_mean_absolute_error_labels: 0.4415\n","Epoch 59: early stopping\n","CPU times: user 1h 1min 54s, sys: 7min 27s, total: 1h 9min 21s\n","Wall time: 1h 22min 15s\n"]}]},{"cell_type":"code","source":["from sklearn.metrics import precision_score, f1_score, classification_report\n","from sklearn.metrics import ConfusionMatrixDisplay\n","from sklearn.metrics import confusion_matrix\n","import matplotlib.pyplot as plt\n","import numpy as np\n","\n","from sklearn.metrics import mean_absolute_error\n","\n","\n","\n","checkpoint_path = \"/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Models/cp_one_metric_mae.ckpt\"\n","# checkpoint_path = \"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_allmetrics.ckpt/\"\n","checkpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/FinalProject_LakshyanaKC_NhatPham/Models/\")\n","\n","\n","### Update the label from 0-3 back to original ratings 2-5\n","def update_labels(label):\n","  return label+2\n","\n","\n","## Get the test dataset\n","test_dataset = tf.data.Dataset.from_tensor_slices(\n","  (tf.cast(np.array(X_test_indices)[..., tf.newaxis], tf.float32),\n","   tf.cast(np.array(y_test), tf.int64)))\n","\n","test_dataset = test_dataset.shuffle(50).batch(batch_size)\n","\n","\n","\n","## Create model instance\n","model = create_model()\n","\n","# Loads the weights\n","model.load_weights(checkpoint_path)\n","\n","## Evaluate the model on test dataset\n","model.evaluate(test_dataset)\n","\n","# Note that these are ordinal (cumulative) logits, not probabilities or regular logits.\n","ordinal_logits = model.predict(test_dataset)\n","\n","# Convert from logits to label probabilities. This is initially a tensorflow tensor.\n","tensor_probs = coral.ordinal_softmax(ordinal_logits)\n","\n","# Convert the tensor into a pandas dataframe.\n","probs_df = pd.DataFrame(tensor_probs.numpy())\n","\n","\n","from scipy import special\n","\n","# Compare to logit-based cumulative probs\n","cum_probs = pd.DataFrame(ordinal_logits).apply(special.expit)\n","\n","# Calculate the labels using the style of Cao et al.\n","labels = cum_probs.apply(lambda x: x > 0.5).sum(axis = 1)\n","\n","\n","\n","\n","### \n","predictions = pd.DataFrame()\n","predictions[\"predicted_label\"]  = np.argmax(tensor_probs.numpy(), axis = 1)\n","predictions[\"true_label\"]       = y_test\n","\n","\n","# predictions[\"predicted_label\"]  = predictions[\"predicted_label\"].apply(update_labels)\n","# predictions[\"true_label\"]       = predictions[\"true_label\"].apply(update_labels)\n","\n","\n","y_pred = predictions[\"predicted_label\"].to_numpy()\n","y_true = predictions[\"true_label\"].to_numpy()\n","labels =  ['Class 1-2', 'Class 3', 'Class 4', 'Class 5']\n","\n","cm = confusion_matrix(y_true, y_pred)\n","\n","disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=labels)\n","\n","disp.plot(cmap=plt.cm.Blues)\n","plt.show()\n","\n","\n","predictions = pd.DataFrame()\n","predictions[\"predicted_label\"]  = np.argmax(tensor_probs.numpy(), axis = 1)\n","predictions[\"true_label\"]       = y_test\n","\n","# y_pred = predictions[\"predicted_label\"].to_numpy()\n","# y_true = predictions[\"true_label\"].to_numpy()\n","\n","target_names = ['class 2', 'class 3', 'class 4','class 5']\n","print(\"\\n\\tMean Absolute Error: \",mean_absolute_error(y_true,y_pred),\"\\n\")\n","print(classification_report(y_true, y_pred, target_names=target_names))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":677},"id":"Na7TClBT0N7w","executionInfo":{"status":"ok","timestamp":1651618272100,"user_tz":240,"elapsed":28210,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"1772cc59-4d17-45c2-f1d9-8a87d0144f9b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["225/225 [==============================] - 4s 3ms/step - loss: 0.9738 - mean_absolute_error_labels: 0.4321\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}},{"output_type":"stream","name":"stdout","text":["\n","\tMean Absolute Error:  0.4320153288574654 \n","\n","              precision    recall  f1-score   support\n","\n","     class 2       0.00      0.00      0.00      1098\n","     class 3       0.00      0.00      0.00      3299\n","     class 4       0.00      0.00      0.00     19193\n","     class 5       0.65      1.00      0.79     43734\n","\n","    accuracy                           0.65     67324\n","   macro avg       0.16      0.25      0.20     67324\n","weighted avg       0.42      0.65      0.51     67324\n","\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}]},{"cell_type":"code","source":["%%time\n","\n","from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint\n","\n","\n","learning_rate = 0.01\n","batch_size = 200\n","num_epochs = 500\n","\n","\n","checkpoint_path = \"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_allmetrics.ckpt\"\n","checkpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/\")\n","\n","\n","callbacks = [tf.keras.callbacks.EarlyStopping(\n","                        monitor='val_loss',\n","                        mode='min', \n","                        verbose=1, \n","                        patience = 200,\n","                        restore_best_weights = True),          \n","              ModelCheckpoint(filepath=checkpoint_path, monitor='val_loss', save_best_only=True, mode='min')]\n","\n","# callbacks = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_path,\n","#                                                  save_weights_only=True,\n","#                                                  verbose=1)\n","\n","model = create_model()\n","\n","\n","history = model.fit(dataset, \n","                    epochs = num_epochs,\n","                    validation_data = val_dataset,\n","                    class_weight = class_weights,\n","                    use_multiprocessing=True,\n","                    callbacks=callbacks\n","                    )\n","\n","\n","## Save the history\n","np.save('/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/model1_history.npy',history.history)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"eJijkYdmQooH","executionInfo":{"status":"error","timestamp":1651555027992,"user_tz":240,"elapsed":492717,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"133f1d1d-cc8a-4469-f8dc-2582654de691"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/500\n","398/404 [============================>.] - ETA: 0s - loss: 1.0430 - mean_absolute_error_labels: 0.4393 - f1_m: 1.5389 - precision_m: 1.0423 - recall_m: 2.9440INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp1.ckpt/assets\n","404/404 [==============================] - 90s 221ms/step - loss: 1.0412 - mean_absolute_error_labels: 0.4390 - f1_m: 1.5392 - precision_m: 1.0426 - recall_m: 2.9438 - val_loss: 0.9993 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4808 - val_precision_m: 0.9830 - val_recall_m: 2.9998\n","Epoch 2/500\n","400/404 [============================>.] - ETA: 0s - loss: 0.9886 - mean_absolute_error_labels: 0.4374 - f1_m: 1.5681 - precision_m: 1.0695 - recall_m: 2.9414INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp1.ckpt/assets\n","404/404 [==============================] - 89s 220ms/step - loss: 0.9882 - mean_absolute_error_labels: 0.4372 - f1_m: 1.5679 - precision_m: 1.0693 - recall_m: 2.9416 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4828 - val_precision_m: 0.9849 - val_recall_m: 2.9983\n","Epoch 3/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9859 - mean_absolute_error_labels: 0.4358 - f1_m: 1.5694 - precision_m: 1.0685 - recall_m: 2.9585 - val_loss: 0.9978 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4811 - val_precision_m: 0.9833 - val_recall_m: 2.9997\n","Epoch 4/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9840 - mean_absolute_error_labels: 0.4349 - f1_m: 1.5667 - precision_m: 1.0639 - recall_m: 2.9747 - val_loss: 0.9981 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4801 - val_precision_m: 0.9824 - val_recall_m: 2.9996\n","Epoch 5/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9826 - mean_absolute_error_labels: 0.4347 - f1_m: 1.5628 - precision_m: 1.0593 - recall_m: 2.9829 - val_loss: 0.9982 - val_mean_absolute_error_labels: 0.4418 - val_f1_m: 1.4921 - val_precision_m: 0.9943 - val_recall_m: 2.9890\n","Epoch 6/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9816 - mean_absolute_error_labels: 0.4347 - f1_m: 1.5508 - precision_m: 1.0477 - recall_m: 2.9887 - val_loss: 0.9989 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4857 - val_precision_m: 0.9880 - val_recall_m: 2.9943\n","Epoch 7/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9806 - mean_absolute_error_labels: 0.4347 - f1_m: 1.5338 - precision_m: 1.0318 - recall_m: 2.9912 - val_loss: 0.9987 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4954 - val_precision_m: 0.9964 - val_recall_m: 2.9957\n","Epoch 8/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9800 - mean_absolute_error_labels: 0.4346 - f1_m: 1.5250 - precision_m: 1.0235 - recall_m: 2.9925 - val_loss: 0.9985 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.4916 - val_precision_m: 0.9929 - val_recall_m: 2.9972\n","Epoch 9/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9795 - mean_absolute_error_labels: 0.4346 - f1_m: 1.5183 - precision_m: 1.0172 - recall_m: 2.9943 - val_loss: 0.9997 - val_mean_absolute_error_labels: 0.4415 - val_f1_m: 1.5155 - val_precision_m: 1.0146 - val_recall_m: 2.9934\n","Epoch 10/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9793 - mean_absolute_error_labels: 0.4347 - f1_m: 1.5171 - precision_m: 1.0162 - recall_m: 2.9936 - val_loss: 0.9998 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.5010 - val_precision_m: 1.0013 - val_recall_m: 2.9964\n","Epoch 11/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9787 - mean_absolute_error_labels: 0.4346 - f1_m: 1.5179 - precision_m: 1.0171 - recall_m: 2.9923 - val_loss: 1.0003 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.5262 - val_precision_m: 1.0245 - val_recall_m: 2.9911\n","Epoch 12/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9786 - mean_absolute_error_labels: 0.4347 - f1_m: 1.5221 - precision_m: 1.0209 - recall_m: 2.9917 - val_loss: 0.9999 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.5131 - val_precision_m: 1.0124 - val_recall_m: 2.9940\n","Epoch 13/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9785 - mean_absolute_error_labels: 0.4348 - f1_m: 1.5119 - precision_m: 1.0116 - recall_m: 2.9924 - val_loss: 0.9993 - val_mean_absolute_error_labels: 0.4414 - val_f1_m: 1.4842 - val_precision_m: 0.9861 - val_recall_m: 2.9995\n","Epoch 14/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9780 - mean_absolute_error_labels: 0.4347 - f1_m: 1.5052 - precision_m: 1.0057 - recall_m: 2.9913 - val_loss: 1.0006 - val_mean_absolute_error_labels: 0.4413 - val_f1_m: 1.5018 - val_precision_m: 1.0022 - val_recall_m: 2.9943\n","Epoch 15/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9778 - mean_absolute_error_labels: 0.4346 - f1_m: 1.5020 - precision_m: 1.0030 - recall_m: 2.9905 - val_loss: 0.9999 - val_mean_absolute_error_labels: 0.4417 - val_f1_m: 1.5014 - val_precision_m: 1.0021 - val_recall_m: 2.9921\n","Epoch 16/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9775 - mean_absolute_error_labels: 0.4345 - f1_m: 1.5018 - precision_m: 1.0029 - recall_m: 2.9899 - val_loss: 1.0010 - val_mean_absolute_error_labels: 0.4428 - val_f1_m: 1.4896 - val_precision_m: 0.9916 - val_recall_m: 2.9923\n","Epoch 17/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9774 - mean_absolute_error_labels: 0.4347 - f1_m: 1.4975 - precision_m: 0.9990 - recall_m: 2.9903 - val_loss: 1.0010 - val_mean_absolute_error_labels: 0.4424 - val_f1_m: 1.4925 - val_precision_m: 0.9943 - val_recall_m: 2.9915\n","Epoch 18/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9771 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4987 - precision_m: 1.0002 - recall_m: 2.9891 - val_loss: 1.0024 - val_mean_absolute_error_labels: 0.4421 - val_f1_m: 1.4920 - val_precision_m: 0.9941 - val_recall_m: 2.9895\n","Epoch 19/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9769 - mean_absolute_error_labels: 0.4345 - f1_m: 1.4973 - precision_m: 0.9991 - recall_m: 2.9879 - val_loss: 1.0037 - val_mean_absolute_error_labels: 0.4441 - val_f1_m: 1.4944 - val_precision_m: 0.9966 - val_recall_m: 2.9865\n","Epoch 20/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9765 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4941 - precision_m: 0.9963 - recall_m: 2.9871 - val_loss: 1.0039 - val_mean_absolute_error_labels: 0.4465 - val_f1_m: 1.4922 - val_precision_m: 0.9952 - val_recall_m: 2.9815\n","Epoch 21/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9764 - mean_absolute_error_labels: 0.4346 - f1_m: 1.4948 - precision_m: 0.9967 - recall_m: 2.9879 - val_loss: 1.0025 - val_mean_absolute_error_labels: 0.4450 - val_f1_m: 1.4910 - val_precision_m: 0.9935 - val_recall_m: 2.9866\n","Epoch 22/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9760 - mean_absolute_error_labels: 0.4344 - f1_m: 1.4973 - precision_m: 0.9993 - recall_m: 2.9860 - val_loss: 1.0040 - val_mean_absolute_error_labels: 0.4455 - val_f1_m: 1.4912 - val_precision_m: 0.9938 - val_recall_m: 2.9854\n","Epoch 23/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9755 - mean_absolute_error_labels: 0.4343 - f1_m: 1.4977 - precision_m: 0.9997 - recall_m: 2.9854 - val_loss: 1.0073 - val_mean_absolute_error_labels: 0.4480 - val_f1_m: 1.4928 - val_precision_m: 0.9963 - val_recall_m: 2.9763\n","Epoch 24/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9755 - mean_absolute_error_labels: 0.4344 - f1_m: 1.4954 - precision_m: 0.9976 - recall_m: 2.9856 - val_loss: 1.0069 - val_mean_absolute_error_labels: 0.4477 - val_f1_m: 1.4952 - val_precision_m: 0.9985 - val_recall_m: 2.9757\n","Epoch 25/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9751 - mean_absolute_error_labels: 0.4339 - f1_m: 1.4976 - precision_m: 0.9998 - recall_m: 2.9848 - val_loss: 1.0040 - val_mean_absolute_error_labels: 0.4464 - val_f1_m: 1.4925 - val_precision_m: 0.9956 - val_recall_m: 2.9796\n","Epoch 26/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9748 - mean_absolute_error_labels: 0.4340 - f1_m: 1.4956 - precision_m: 0.9978 - recall_m: 2.9860 - val_loss: 1.0063 - val_mean_absolute_error_labels: 0.4473 - val_f1_m: 1.4874 - val_precision_m: 0.9913 - val_recall_m: 2.9778\n","Epoch 27/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9749 - mean_absolute_error_labels: 0.4338 - f1_m: 1.4905 - precision_m: 0.9931 - recall_m: 2.9871 - val_loss: 1.0051 - val_mean_absolute_error_labels: 0.4471 - val_f1_m: 1.4875 - val_precision_m: 0.9914 - val_recall_m: 2.9778\n","Epoch 28/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9745 - mean_absolute_error_labels: 0.4339 - f1_m: 1.5024 - precision_m: 1.0042 - recall_m: 2.9848 - val_loss: 1.0081 - val_mean_absolute_error_labels: 0.4469 - val_f1_m: 1.5925 - val_precision_m: 1.0884 - val_recall_m: 2.9661\n","Epoch 29/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9746 - mean_absolute_error_labels: 0.4338 - f1_m: 1.4980 - precision_m: 1.0000 - recall_m: 2.9858 - val_loss: 1.0089 - val_mean_absolute_error_labels: 0.4470 - val_f1_m: 1.6037 - val_precision_m: 1.0996 - val_recall_m: 2.9618\n","Epoch 30/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9742 - mean_absolute_error_labels: 0.4340 - f1_m: 1.5075 - precision_m: 1.0089 - recall_m: 2.9840 - val_loss: 1.0082 - val_mean_absolute_error_labels: 0.4484 - val_f1_m: 1.6110 - val_precision_m: 1.1068 - val_recall_m: 2.9597\n","Epoch 31/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9743 - mean_absolute_error_labels: 0.4340 - f1_m: 1.5067 - precision_m: 1.0082 - recall_m: 2.9841 - val_loss: 1.0059 - val_mean_absolute_error_labels: 0.4454 - val_f1_m: 1.6023 - val_precision_m: 1.0973 - val_recall_m: 2.9683\n","Epoch 32/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9741 - mean_absolute_error_labels: 0.4337 - f1_m: 1.5040 - precision_m: 1.0056 - recall_m: 2.9855 - val_loss: 1.0104 - val_mean_absolute_error_labels: 0.4479 - val_f1_m: 1.6025 - val_precision_m: 1.0980 - val_recall_m: 2.9644\n","Epoch 33/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9736 - mean_absolute_error_labels: 0.4339 - f1_m: 1.5013 - precision_m: 1.0030 - recall_m: 2.9863 - val_loss: 1.0087 - val_mean_absolute_error_labels: 0.4456 - val_f1_m: 1.6012 - val_precision_m: 1.0962 - val_recall_m: 2.9688\n","Epoch 34/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9738 - mean_absolute_error_labels: 0.4336 - f1_m: 1.4971 - precision_m: 0.9993 - recall_m: 2.9852 - val_loss: 1.0092 - val_mean_absolute_error_labels: 0.4471 - val_f1_m: 1.5764 - val_precision_m: 1.0730 - val_recall_m: 2.9700\n","Epoch 35/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9736 - mean_absolute_error_labels: 0.4335 - f1_m: 1.5036 - precision_m: 1.0053 - recall_m: 2.9847 - val_loss: 1.0094 - val_mean_absolute_error_labels: 0.4461 - val_f1_m: 1.5786 - val_precision_m: 1.0752 - val_recall_m: 2.9690\n","Epoch 36/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9734 - mean_absolute_error_labels: 0.4337 - f1_m: 1.5135 - precision_m: 1.0145 - recall_m: 2.9826 - val_loss: 1.0077 - val_mean_absolute_error_labels: 0.4446 - val_f1_m: 1.5805 - val_precision_m: 1.0765 - val_recall_m: 2.9722\n","Epoch 37/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9732 - mean_absolute_error_labels: 0.4333 - f1_m: 1.5097 - precision_m: 1.0110 - recall_m: 2.9832 - val_loss: 1.0063 - val_mean_absolute_error_labels: 0.4445 - val_f1_m: 1.5975 - val_precision_m: 1.0925 - val_recall_m: 2.9706\n","Epoch 38/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9729 - mean_absolute_error_labels: 0.4334 - f1_m: 1.5218 - precision_m: 1.0222 - recall_m: 2.9823 - val_loss: 1.0084 - val_mean_absolute_error_labels: 0.4470 - val_f1_m: 1.5874 - val_precision_m: 1.0833 - val_recall_m: 2.9692\n","Epoch 39/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9730 - mean_absolute_error_labels: 0.4334 - f1_m: 1.5189 - precision_m: 1.0194 - recall_m: 2.9830 - val_loss: 1.0080 - val_mean_absolute_error_labels: 0.4457 - val_f1_m: 1.5993 - val_precision_m: 1.0942 - val_recall_m: 2.9706\n","Epoch 40/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9725 - mean_absolute_error_labels: 0.4332 - f1_m: 1.5176 - precision_m: 1.0183 - recall_m: 2.9824 - val_loss: 1.0081 - val_mean_absolute_error_labels: 0.4467 - val_f1_m: 1.4846 - val_precision_m: 0.9881 - val_recall_m: 2.9843\n","Epoch 41/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9725 - mean_absolute_error_labels: 0.4331 - f1_m: 1.4955 - precision_m: 0.9978 - recall_m: 2.9859 - val_loss: 1.0077 - val_mean_absolute_error_labels: 0.4464 - val_f1_m: 1.4836 - val_precision_m: 0.9871 - val_recall_m: 2.9857\n","Epoch 42/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9723 - mean_absolute_error_labels: 0.4330 - f1_m: 1.4960 - precision_m: 0.9983 - recall_m: 2.9863 - val_loss: 1.0055 - val_mean_absolute_error_labels: 0.4453 - val_f1_m: 1.4833 - val_precision_m: 0.9865 - val_recall_m: 2.9887\n","Epoch 43/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9725 - mean_absolute_error_labels: 0.4333 - f1_m: 1.4955 - precision_m: 0.9978 - recall_m: 2.9865 - val_loss: 1.0054 - val_mean_absolute_error_labels: 0.4438 - val_f1_m: 1.5934 - val_precision_m: 1.0882 - val_recall_m: 2.9747\n","Epoch 44/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9723 - mean_absolute_error_labels: 0.4332 - f1_m: 1.4960 - precision_m: 0.9984 - recall_m: 2.9849 - val_loss: 1.0064 - val_mean_absolute_error_labels: 0.4454 - val_f1_m: 1.4846 - val_precision_m: 0.9877 - val_recall_m: 2.9880\n","Epoch 45/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9721 - mean_absolute_error_labels: 0.4332 - f1_m: 1.4958 - precision_m: 0.9983 - recall_m: 2.9847 - val_loss: 1.0051 - val_mean_absolute_error_labels: 0.4446 - val_f1_m: 1.4827 - val_precision_m: 0.9858 - val_recall_m: 2.9897\n","Epoch 46/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9724 - mean_absolute_error_labels: 0.4331 - f1_m: 1.4870 - precision_m: 0.9899 - recall_m: 2.9871 - val_loss: 1.0074 - val_mean_absolute_error_labels: 0.4452 - val_f1_m: 1.4834 - val_precision_m: 0.9867 - val_recall_m: 2.9874\n","Epoch 47/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9720 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5103 - precision_m: 1.0116 - recall_m: 2.9841 - val_loss: 1.0082 - val_mean_absolute_error_labels: 0.4461 - val_f1_m: 1.6103 - val_precision_m: 1.1050 - val_recall_m: 2.9678\n","Epoch 48/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9719 - mean_absolute_error_labels: 0.4330 - f1_m: 1.5160 - precision_m: 1.0169 - recall_m: 2.9841 - val_loss: 1.0083 - val_mean_absolute_error_labels: 0.4456 - val_f1_m: 1.5953 - val_precision_m: 1.0905 - val_recall_m: 2.9709\n","Epoch 49/500\n","404/404 [==============================] - 3s 8ms/step - loss: 0.9717 - mean_absolute_error_labels: 0.4330 - f1_m: 1.5079 - precision_m: 1.0094 - recall_m: 2.9851 - val_loss: 1.0116 - val_mean_absolute_error_labels: 0.4452 - val_f1_m: 1.5860 - val_precision_m: 1.0818 - val_recall_m: 2.9711\n","Epoch 50/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9714 - mean_absolute_error_labels: 0.4327 - f1_m: 1.5301 - precision_m: 1.0301 - recall_m: 2.9809 - val_loss: 1.0083 - val_mean_absolute_error_labels: 0.4457 - val_f1_m: 1.6051 - val_precision_m: 1.0999 - val_recall_m: 2.9692\n","Epoch 51/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9718 - mean_absolute_error_labels: 0.4329 - f1_m: 1.5106 - precision_m: 1.0118 - recall_m: 2.9853 - val_loss: 1.0085 - val_mean_absolute_error_labels: 0.4449 - val_f1_m: 1.5868 - val_precision_m: 1.0821 - val_recall_m: 2.9736\n","Epoch 52/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9719 - mean_absolute_error_labels: 0.4331 - f1_m: 1.5118 - precision_m: 1.0130 - recall_m: 2.9847 - val_loss: 1.0088 - val_mean_absolute_error_labels: 0.4453 - val_f1_m: 1.5865 - val_precision_m: 1.0820 - val_recall_m: 2.9724\n","Epoch 53/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9712 - mean_absolute_error_labels: 0.4326 - f1_m: 1.5089 - precision_m: 1.0102 - recall_m: 2.9850 - val_loss: 1.0095 - val_mean_absolute_error_labels: 0.4446 - val_f1_m: 1.5950 - val_precision_m: 1.0898 - val_recall_m: 2.9739\n","Epoch 54/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9714 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5229 - precision_m: 1.0232 - recall_m: 2.9827 - val_loss: 1.0109 - val_mean_absolute_error_labels: 0.4452 - val_f1_m: 1.5822 - val_precision_m: 1.0781 - val_recall_m: 2.9720\n","Epoch 55/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9709 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5281 - precision_m: 1.0280 - recall_m: 2.9818 - val_loss: 1.0101 - val_mean_absolute_error_labels: 0.4442 - val_f1_m: 1.6054 - val_precision_m: 1.1000 - val_recall_m: 2.9704\n","Epoch 56/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9714 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5331 - precision_m: 1.0326 - recall_m: 2.9818 - val_loss: 1.0099 - val_mean_absolute_error_labels: 0.4449 - val_f1_m: 1.6018 - val_precision_m: 1.0965 - val_recall_m: 2.9714\n","Epoch 57/500\n","404/404 [==============================] - 3s 8ms/step - loss: 0.9710 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5322 - precision_m: 1.0319 - recall_m: 2.9815 - val_loss: 1.0093 - val_mean_absolute_error_labels: 0.4447 - val_f1_m: 1.5931 - val_precision_m: 1.0884 - val_recall_m: 2.9713\n","Epoch 58/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9709 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5236 - precision_m: 1.0238 - recall_m: 2.9829 - val_loss: 1.0092 - val_mean_absolute_error_labels: 0.4452 - val_f1_m: 1.5894 - val_precision_m: 1.0849 - val_recall_m: 2.9712\n","Epoch 59/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9709 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5160 - precision_m: 1.0169 - recall_m: 2.9837 - val_loss: 1.0093 - val_mean_absolute_error_labels: 0.4444 - val_f1_m: 1.5997 - val_precision_m: 1.0944 - val_recall_m: 2.9723\n","Epoch 60/500\n","404/404 [==============================] - 3s 8ms/step - loss: 0.9712 - mean_absolute_error_labels: 0.4327 - f1_m: 1.5178 - precision_m: 1.0185 - recall_m: 2.9835 - val_loss: 1.0097 - val_mean_absolute_error_labels: 0.4440 - val_f1_m: 1.6086 - val_precision_m: 1.1026 - val_recall_m: 2.9730\n","Epoch 61/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9706 - mean_absolute_error_labels: 0.4325 - f1_m: 1.5273 - precision_m: 1.0273 - recall_m: 2.9823 - val_loss: 1.0095 - val_mean_absolute_error_labels: 0.4446 - val_f1_m: 1.5957 - val_precision_m: 1.0907 - val_recall_m: 2.9718\n","Epoch 62/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9706 - mean_absolute_error_labels: 0.4326 - f1_m: 1.5200 - precision_m: 1.0205 - recall_m: 2.9832 - val_loss: 1.0116 - val_mean_absolute_error_labels: 0.4448 - val_f1_m: 1.5983 - val_precision_m: 1.0931 - val_recall_m: 2.9721\n","Epoch 63/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9708 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5312 - precision_m: 1.0308 - recall_m: 2.9816 - val_loss: 1.0128 - val_mean_absolute_error_labels: 0.4449 - val_f1_m: 1.6044 - val_precision_m: 1.0989 - val_recall_m: 2.9715\n","Epoch 64/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9705 - mean_absolute_error_labels: 0.4324 - f1_m: 1.5377 - precision_m: 1.0370 - recall_m: 2.9802 - val_loss: 1.0102 - val_mean_absolute_error_labels: 0.4444 - val_f1_m: 1.6039 - val_precision_m: 1.0983 - val_recall_m: 2.9729\n","Epoch 65/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9706 - mean_absolute_error_labels: 0.4326 - f1_m: 1.5220 - precision_m: 1.0223 - recall_m: 2.9832 - val_loss: 1.0099 - val_mean_absolute_error_labels: 0.4439 - val_f1_m: 1.6006 - val_precision_m: 1.0948 - val_recall_m: 2.9752\n","Epoch 66/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9705 - mean_absolute_error_labels: 0.4326 - f1_m: 1.5285 - precision_m: 1.0282 - recall_m: 2.9825 - val_loss: 1.0131 - val_mean_absolute_error_labels: 0.4440 - val_f1_m: 1.6095 - val_precision_m: 1.1034 - val_recall_m: 2.9738\n","Epoch 67/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9703 - mean_absolute_error_labels: 0.4328 - f1_m: 1.5327 - precision_m: 1.0323 - recall_m: 2.9818 - val_loss: 1.0116 - val_mean_absolute_error_labels: 0.4444 - val_f1_m: 1.6171 - val_precision_m: 1.1107 - val_recall_m: 2.9725\n","Epoch 68/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9703 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5316 - precision_m: 1.0312 - recall_m: 2.9825 - val_loss: 1.0118 - val_mean_absolute_error_labels: 0.4443 - val_f1_m: 1.6035 - val_precision_m: 1.0978 - val_recall_m: 2.9731\n","Epoch 69/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9708 - mean_absolute_error_labels: 0.4327 - f1_m: 1.5206 - precision_m: 1.0210 - recall_m: 2.9840 - val_loss: 1.0129 - val_mean_absolute_error_labels: 0.4452 - val_f1_m: 1.4808 - val_precision_m: 0.9845 - val_recall_m: 2.9868\n","Epoch 70/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9699 - mean_absolute_error_labels: 0.4324 - f1_m: 1.5324 - precision_m: 1.0318 - recall_m: 2.9822 - val_loss: 1.0112 - val_mean_absolute_error_labels: 0.4451 - val_f1_m: 1.4810 - val_precision_m: 0.9845 - val_recall_m: 2.9880\n","Epoch 71/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9707 - mean_absolute_error_labels: 0.4326 - f1_m: 1.5118 - precision_m: 1.0128 - recall_m: 2.9851 - val_loss: 1.0093 - val_mean_absolute_error_labels: 0.4442 - val_f1_m: 1.4808 - val_precision_m: 0.9842 - val_recall_m: 2.9898\n","Epoch 72/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9702 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5136 - precision_m: 1.0145 - recall_m: 2.9848 - val_loss: 1.0125 - val_mean_absolute_error_labels: 0.4458 - val_f1_m: 1.6022 - val_precision_m: 1.0967 - val_recall_m: 2.9723\n","Epoch 73/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9703 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5214 - precision_m: 1.0217 - recall_m: 2.9840 - val_loss: 1.0097 - val_mean_absolute_error_labels: 0.4445 - val_f1_m: 1.4808 - val_precision_m: 0.9840 - val_recall_m: 2.9907\n","Epoch 74/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9702 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5281 - precision_m: 1.0278 - recall_m: 2.9829 - val_loss: 1.0114 - val_mean_absolute_error_labels: 0.4444 - val_f1_m: 1.5905 - val_precision_m: 1.0857 - val_recall_m: 2.9733\n","Epoch 75/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9698 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5334 - precision_m: 1.0328 - recall_m: 2.9820 - val_loss: 1.0090 - val_mean_absolute_error_labels: 0.4451 - val_f1_m: 1.6086 - val_precision_m: 1.1030 - val_recall_m: 2.9708\n","Epoch 76/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9702 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5223 - precision_m: 1.0225 - recall_m: 2.9833 - val_loss: 1.0099 - val_mean_absolute_error_labels: 0.4448 - val_f1_m: 1.5986 - val_precision_m: 1.0932 - val_recall_m: 2.9735\n","Epoch 77/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9700 - mean_absolute_error_labels: 0.4324 - f1_m: 1.5213 - precision_m: 1.0216 - recall_m: 2.9837 - val_loss: 1.0114 - val_mean_absolute_error_labels: 0.4448 - val_f1_m: 1.6092 - val_precision_m: 1.1033 - val_recall_m: 2.9726\n","Epoch 78/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9701 - mean_absolute_error_labels: 0.4324 - f1_m: 1.5253 - precision_m: 1.0253 - recall_m: 2.9835 - val_loss: 1.0097 - val_mean_absolute_error_labels: 0.4437 - val_f1_m: 1.6031 - val_precision_m: 1.0974 - val_recall_m: 2.9739\n","Epoch 79/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9694 - mean_absolute_error_labels: 0.4325 - f1_m: 1.5253 - precision_m: 1.0253 - recall_m: 2.9832 - val_loss: 1.0087 - val_mean_absolute_error_labels: 0.4439 - val_f1_m: 1.5999 - val_precision_m: 1.0941 - val_recall_m: 2.9761\n","Epoch 80/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9700 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5241 - precision_m: 1.0242 - recall_m: 2.9835 - val_loss: 1.0052 - val_mean_absolute_error_labels: 0.4435 - val_f1_m: 1.6032 - val_precision_m: 1.0973 - val_recall_m: 2.9753\n","Epoch 81/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9698 - mean_absolute_error_labels: 0.4324 - f1_m: 1.5280 - precision_m: 1.0278 - recall_m: 2.9829 - val_loss: 1.0090 - val_mean_absolute_error_labels: 0.4448 - val_f1_m: 1.6013 - val_precision_m: 1.0958 - val_recall_m: 2.9727\n","Epoch 82/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9699 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5139 - precision_m: 1.0148 - recall_m: 2.9842 - val_loss: 1.0118 - val_mean_absolute_error_labels: 0.4441 - val_f1_m: 1.4815 - val_precision_m: 0.9847 - val_recall_m: 2.9899\n","Epoch 83/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9700 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5062 - precision_m: 1.0077 - recall_m: 2.9855 - val_loss: 1.0076 - val_mean_absolute_error_labels: 0.4443 - val_f1_m: 1.4813 - val_precision_m: 0.9844 - val_recall_m: 2.9906\n","Epoch 84/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9696 - mean_absolute_error_labels: 0.4325 - f1_m: 1.5030 - precision_m: 1.0046 - recall_m: 2.9867 - val_loss: 1.0072 - val_mean_absolute_error_labels: 0.4431 - val_f1_m: 1.4813 - val_precision_m: 0.9842 - val_recall_m: 2.9924\n","Epoch 85/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9699 - mean_absolute_error_labels: 0.4325 - f1_m: 1.5062 - precision_m: 1.0076 - recall_m: 2.9861 - val_loss: 1.0099 - val_mean_absolute_error_labels: 0.4441 - val_f1_m: 1.4816 - val_precision_m: 0.9847 - val_recall_m: 2.9908\n","Epoch 86/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9696 - mean_absolute_error_labels: 0.4324 - f1_m: 1.5111 - precision_m: 1.0122 - recall_m: 2.9855 - val_loss: 1.0098 - val_mean_absolute_error_labels: 0.4437 - val_f1_m: 1.5984 - val_precision_m: 1.0930 - val_recall_m: 2.9735\n","Epoch 87/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9696 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5117 - precision_m: 1.0127 - recall_m: 2.9856 - val_loss: 1.0093 - val_mean_absolute_error_labels: 0.4440 - val_f1_m: 1.4810 - val_precision_m: 0.9841 - val_recall_m: 2.9916\n","Epoch 88/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9695 - mean_absolute_error_labels: 0.4319 - f1_m: 1.5155 - precision_m: 1.0162 - recall_m: 2.9851 - val_loss: 1.0104 - val_mean_absolute_error_labels: 0.4449 - val_f1_m: 1.4814 - val_precision_m: 0.9848 - val_recall_m: 2.9882\n","Epoch 89/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9696 - mean_absolute_error_labels: 0.4321 - f1_m: 1.5152 - precision_m: 1.0159 - recall_m: 2.9845 - val_loss: 1.0108 - val_mean_absolute_error_labels: 0.4453 - val_f1_m: 1.6020 - val_precision_m: 1.0968 - val_recall_m: 2.9703\n","Epoch 90/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9692 - mean_absolute_error_labels: 0.4321 - f1_m: 1.5141 - precision_m: 1.0150 - recall_m: 2.9848 - val_loss: 1.0110 - val_mean_absolute_error_labels: 0.4446 - val_f1_m: 1.4810 - val_precision_m: 0.9843 - val_recall_m: 2.9902\n","Epoch 91/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9697 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5074 - precision_m: 1.0087 - recall_m: 2.9857 - val_loss: 1.0117 - val_mean_absolute_error_labels: 0.4443 - val_f1_m: 1.5903 - val_precision_m: 1.0851 - val_recall_m: 2.9753\n","Epoch 92/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9692 - mean_absolute_error_labels: 0.4320 - f1_m: 1.5075 - precision_m: 1.0088 - recall_m: 2.9853 - val_loss: 1.0108 - val_mean_absolute_error_labels: 0.4433 - val_f1_m: 1.4805 - val_precision_m: 0.9837 - val_recall_m: 2.9909\n","Epoch 93/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9690 - mean_absolute_error_labels: 0.4321 - f1_m: 1.5221 - precision_m: 1.0224 - recall_m: 2.9834 - val_loss: 1.0109 - val_mean_absolute_error_labels: 0.4439 - val_f1_m: 1.4807 - val_precision_m: 0.9841 - val_recall_m: 2.9895\n","Epoch 94/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9693 - mean_absolute_error_labels: 0.4321 - f1_m: 1.5259 - precision_m: 1.0259 - recall_m: 2.9833 - val_loss: 1.0112 - val_mean_absolute_error_labels: 0.4435 - val_f1_m: 1.6049 - val_precision_m: 1.0991 - val_recall_m: 2.9733\n","Epoch 95/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9692 - mean_absolute_error_labels: 0.4319 - f1_m: 1.5144 - precision_m: 1.0152 - recall_m: 2.9851 - val_loss: 1.0115 - val_mean_absolute_error_labels: 0.4437 - val_f1_m: 1.4815 - val_precision_m: 0.9846 - val_recall_m: 2.9906\n","Epoch 96/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9693 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5156 - precision_m: 1.0163 - recall_m: 2.9851 - val_loss: 1.0110 - val_mean_absolute_error_labels: 0.4446 - val_f1_m: 1.4811 - val_precision_m: 0.9843 - val_recall_m: 2.9903\n","Epoch 97/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9691 - mean_absolute_error_labels: 0.4321 - f1_m: 1.5197 - precision_m: 1.0201 - recall_m: 2.9841 - val_loss: 1.0122 - val_mean_absolute_error_labels: 0.4452 - val_f1_m: 1.5975 - val_precision_m: 1.0921 - val_recall_m: 2.9734\n","Epoch 98/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9696 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5238 - precision_m: 1.0238 - recall_m: 2.9842 - val_loss: 1.0127 - val_mean_absolute_error_labels: 0.4447 - val_f1_m: 1.4806 - val_precision_m: 0.9840 - val_recall_m: 2.9895\n","Epoch 99/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9695 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5124 - precision_m: 1.0134 - recall_m: 2.9851 - val_loss: 1.0099 - val_mean_absolute_error_labels: 0.4437 - val_f1_m: 1.4813 - val_precision_m: 0.9844 - val_recall_m: 2.9912\n","Epoch 100/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9692 - mean_absolute_error_labels: 0.4323 - f1_m: 1.5116 - precision_m: 1.0127 - recall_m: 2.9849 - val_loss: 1.0099 - val_mean_absolute_error_labels: 0.4437 - val_f1_m: 1.4816 - val_precision_m: 0.9848 - val_recall_m: 2.9899\n","Epoch 101/500\n","404/404 [==============================] - 3s 8ms/step - loss: 0.9695 - mean_absolute_error_labels: 0.4320 - f1_m: 1.5090 - precision_m: 1.0101 - recall_m: 2.9861 - val_loss: 1.0096 - val_mean_absolute_error_labels: 0.4436 - val_f1_m: 1.5994 - val_precision_m: 1.0938 - val_recall_m: 2.9750\n","Epoch 102/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9695 - mean_absolute_error_labels: 0.4322 - f1_m: 1.5100 - precision_m: 1.0111 - recall_m: 2.9852 - val_loss: 1.0124 - val_mean_absolute_error_labels: 0.4441 - val_f1_m: 1.4814 - val_precision_m: 0.9846 - val_recall_m: 2.9902\n","Epoch 103/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9690 - mean_absolute_error_labels: 0.4320 - f1_m: 1.5115 - precision_m: 1.0125 - recall_m: 2.9855 - val_loss: 1.0122 - val_mean_absolute_error_labels: 0.4446 - val_f1_m: 1.4811 - val_precision_m: 0.9844 - val_recall_m: 2.9891\n","Epoch 104/500\n","404/404 [==============================] - 3s 7ms/step - loss: 0.9689 - mean_absolute_error_labels: 0.4320 - f1_m: 1.5115 - precision_m: 1.0125 - recall_m: 2.9851 - val_loss: 1.0122 - val_mean_absolute_error_labels: 0.4442 - val_f1_m: 1.6022 - val_precision_m: 1.0963 - val_recall_m: 2.9750\n","Epoch 105/500\n"," 38/404 [=>............................] - ETA: 2s - loss: 0.9574 - mean_absolute_error_labels: 0.4291 - f1_m: 1.5028 - precision_m: 1.0046 - recall_m: 2.9850"]},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-41-540a6bc459f3>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mget_ipython\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrun_cell_magic\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'time'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m''\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'\\nfrom tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint\\n\\n\\nlearning_rate = 0.01\\nbatch_size = 200\\nnum_epochs = 500\\n\\n\\n\\ncheckpoint_path = \"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp1.ckpt\"\\ncheckpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/\")\\n\\n\\ncallbacks = [tf.keras.callbacks.EarlyStopping(\\n                        monitor=\\'val_loss\\',\\n                        mode=\\'min\\', \\n                        verbose=1, \\n                        patience = 200,\\n                        restore_best_weights = True),          \\n              ModelCheckpoint(filepath=checkpoint_path, monitor=\\'val_loss\\', save_best_only=True, mode=\\'min\\')]\\n\\n# callbacks = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_path,\\n#                                                  save_weights_only=True,\\n#                                                  verbose=1)\\n\\nmodel = create_model()\\n\\n\\nhistory = model.fit(dataset, \\n                    epochs = num_epochs,\\n                    validation_data = val_dataset,\\n                    class_weight = class_weights,\\n                    use_multiprocessing=True,\\n                    callbacks=callbacks\\n                    )\\n\\n\\n## ...\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\u001b[0m in \u001b[0;36mrun_cell_magic\u001b[0;34m(self, magic_name, line, cell)\u001b[0m\n\u001b[1;32m   2115\u001b[0m             \u001b[0mmagic_arg_s\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvar_expand\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mline\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstack_depth\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2116\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbuiltin_trap\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2117\u001b[0;31m                 \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmagic_arg_s\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcell\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2118\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2119\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<decorator-gen-53>\u001b[0m in \u001b[0;36mtime\u001b[0;34m(self, line, cell, local_ns)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/IPython/core/magic.py\u001b[0m in \u001b[0;36m<lambda>\u001b[0;34m(f, *a, **k)\u001b[0m\n\u001b[1;32m    186\u001b[0m     \u001b[0;31m# but it's overkill for just that one bit of state.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    187\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mmagic_deco\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marg\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 188\u001b[0;31m         \u001b[0mcall\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mlambda\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    189\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    190\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mcallable\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marg\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/IPython/core/magics/execution.py\u001b[0m in \u001b[0;36mtime\u001b[0;34m(self, line, cell, local_ns)\u001b[0m\n\u001b[1;32m   1191\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1192\u001b[0m             \u001b[0mst\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mclock2\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1193\u001b[0;31m             \u001b[0mexec\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcode\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mglob\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlocal_ns\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1194\u001b[0m             \u001b[0mend\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mclock2\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1195\u001b[0m             \u001b[0mout\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<timed exec>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     62\u001b[0m     \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     63\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 64\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     65\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m  \u001b[0;31m# pylint: disable=broad-except\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     66\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)\u001b[0m\n\u001b[1;32m   1382\u001b[0m                 _r=1):\n\u001b[1;32m   1383\u001b[0m               \u001b[0mcallbacks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_train_batch_begin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1384\u001b[0;31m               \u001b[0mtmp_logs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrain_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0miterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1385\u001b[0m               \u001b[0;32mif\u001b[0m \u001b[0mdata_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshould_sync\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1386\u001b[0m                 \u001b[0mcontext\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0masync_wait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/util/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    148\u001b[0m     \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    149\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 150\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    151\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    152\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwds)\u001b[0m\n\u001b[1;32m    913\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    914\u001b[0m       \u001b[0;32mwith\u001b[0m \u001b[0mOptionalXlaContext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jit_compile\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 915\u001b[0;31m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    916\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    917\u001b[0m       \u001b[0mnew_tracing_count\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexperimental_get_tracing_count\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\u001b[0m in \u001b[0;36m_call\u001b[0;34m(self, *args, **kwds)\u001b[0m\n\u001b[1;32m    945\u001b[0m       \u001b[0;31m# In this case we have created variables on the first call, so we run the\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    946\u001b[0m       \u001b[0;31m# defunned version which is guaranteed to never create variables.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 947\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_stateless_fn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# pylint: disable=not-callable\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    948\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_stateful_fn\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    949\u001b[0m       \u001b[0;31m# Release the lock early so that multiple threads can perform the call\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   2953\u001b[0m     \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_lock\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2954\u001b[0m       (graph_function,\n\u001b[0;32m-> 2955\u001b[0;31m        filtered_flat_args) = self._maybe_define_function(args, kwargs)\n\u001b[0m\u001b[1;32m   2956\u001b[0m     return graph_function._call_flat(\n\u001b[1;32m   2957\u001b[0m         filtered_flat_args, captured_inputs=graph_function.captured_inputs)  # pylint: disable=protected-access\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\u001b[0m in \u001b[0;36m_maybe_define_function\u001b[0;34m(self, args, kwargs)\u001b[0m\n\u001b[1;32m   3261\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3262\u001b[0m     graph_function = self._function_cache.lookup(cache_key,\n\u001b[0;32m-> 3263\u001b[0;31m                                                  USE_FUNCTION_SUBTYPING)\n\u001b[0m\u001b[1;32m   3264\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mgraph_function\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3265\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0mgraph_function\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfiltered_flat_args\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function_cache.py\u001b[0m in \u001b[0;36mlookup\u001b[0;34m(self, key, use_function_subtyping)\u001b[0m\n\u001b[1;32m    157\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_primary\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    158\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 159\u001b[0;31m     \u001b[0;32mif\u001b[0m \u001b[0mkey\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_primary\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    160\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_primary\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    161\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function_cache.py\u001b[0m in \u001b[0;36m__eq__\u001b[0;34m(self, other)\u001b[0m\n\u001b[1;32m    104\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    105\u001b[0m     return (self.call_context == other.call_context and\n\u001b[0;32m--> 106\u001b[0;31m             self.function_signature == other.function_signature)\n\u001b[0m\u001b[1;32m    107\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    108\u001b[0m   \u001b[0;32mdef\u001b[0m \u001b[0m__repr__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function_trace_type.py\u001b[0m in \u001b[0;36m__eq__\u001b[0;34m(self, other)\u001b[0m\n\u001b[1;32m    206\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    207\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 208\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcomponents\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mother\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcomponents\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    209\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    210\u001b[0m   \u001b[0;32mdef\u001b[0m \u001b[0m__hash__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mint\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function_trace_type.py\u001b[0m in \u001b[0;36m__eq__\u001b[0;34m(self, other)\u001b[0m\n\u001b[1;32m    206\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    207\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 208\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcomponents\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mother\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcomponents\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    209\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    210\u001b[0m   \u001b[0;32mdef\u001b[0m \u001b[0m__hash__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mint\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/data/ops/iterator_ops.py\u001b[0m in \u001b[0;36m__eq__\u001b[0;34m(self, other)\u001b[0m\n\u001b[1;32m    693\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mhash\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_components\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    694\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 695\u001b[0;31m   \u001b[0;32mdef\u001b[0m \u001b[0m__eq__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mother\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mbool\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    696\u001b[0m     return isinstance(\n\u001b[1;32m    697\u001b[0m         other, IteratorType) and self._components == other._components\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","source":[""],"metadata":{"id":"BkWST9yp-sG3"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"uk6jSeGM-sht"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"H14Pdvud-sqq"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"AuANPuay-syx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"Wg3qEFMO-s3a"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"vVhnwd-F-s7B"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.metrics import precision_score, f1_score, classification_report\n","from sklearn.metrics import ConfusionMatrixDisplay\n","from sklearn.metrics import confusion_matrix\n","import matplotlib.pyplot as plt\n","import numpy as np\n","\n","from sklearn.metrics import mean_absolute_error\n","\n","\n","\n","### Update the label from 0-3 back to original ratings 2-5\n","def update_labels(label):\n","  return label+2\n","\n","\n","## Get the test dataset\n","test_dataset = tf.data.Dataset.from_tensor_slices(\n","  (tf.cast(np.array(X_test_indices)[..., tf.newaxis], tf.float32),\n","   tf.cast(np.array(y_test), tf.int64)))\n","\n","test_dataset = test_dataset.shuffle(50).batch(batch_size)\n","\n","checkpoint_path = \"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp1.ckpt\"\n","checkpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/\")\n","\n","## Create model instance\n","model = create_model_with_F1()\n","\n","# Loads the weights\n","model.load_weights(checkpoint_path)\n","\n","## Evaluate the model on test dataset\n","model.evaluate(test_dataset)\n","\n","# Note that these are ordinal (cumulative) logits, not probabilities or regular logits.\n","ordinal_logits = model.predict(test_dataset)\n","\n","# Convert from logits to label probabilities. This is initially a tensorflow tensor.\n","tensor_probs = coral.ordinal_softmax(ordinal_logits)\n","\n","# Convert the tensor into a pandas dataframe.\n","probs_df = pd.DataFrame(tensor_probs.numpy())\n","\n","predictions = pd.DataFrame()\n","predictions[\"predicted_label\"]  = np.argmax(tensor_probs.numpy(), axis = 1)\n","predictions[\"true_label\"]       = y_test\n","\n","predictions[\"predicted_label\"]  = predictions[\"predicted_label\"].apply(update_labels)\n","predictions[\"true_label\"]       = predictions[\"true_label\"].apply(update_labels)\n","\n","\n","y_pred = predictions[\"predicted_label\"].to_numpy()\n","y_true = predictions[\"true_label\"].to_numpy()\n","labels =  ['Class 1-2', 'Class 3', 'Class 4', 'Class 5']\n","\n","cm = confusion_matrix(y_true, y_pred)\n","\n","disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=labels)\n","\n","disp.plot(cmap=plt.cm.Blues)\n","plt.show()\n","\n","\n","predictions = pd.DataFrame()\n","predictions[\"predicted_label\"]  = np.argmax(tensor_probs.numpy(), axis = 1)\n","predictions[\"true_label\"]       = y_test\n","\n","# y_pred = predictions[\"predicted_label\"].to_numpy()\n","# y_true = predictions[\"true_label\"].to_numpy()\n","\n","target_names = ['class 2', 'class 3', 'class 4','class 5']\n","print(\"\\n\\tMean Absolute Error: \",mean_absolute_error(y_true,y_pred),\"\\n\")\n","print(classification_report(y_true, y_pred, target_names=target_names))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":677},"id":"xOQoiiVCvdZB","executionInfo":{"status":"ok","timestamp":1651595266272,"user_tz":240,"elapsed":4898,"user":{"displayName":"Lakshyana K C","userId":"03123992237616606989"}},"outputId":"9cef9788-af79-412a-f011-a2b4468b33ba"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["225/225 [==============================] - 1s 2ms/step - loss: 0.9727 - mean_absolute_error_labels: 0.4322 - f1_m: 1.4852 - precision_m: 0.9870 - recall_m: 2.9991\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}},{"output_type":"stream","name":"stdout","text":["\n","\tMean Absolute Error:  0.4320153288574654 \n","\n","              precision    recall  f1-score   support\n","\n","     class 2       0.00      0.00      0.00      1098\n","     class 3       0.00      0.00      0.00      3299\n","     class 4       0.00      0.00      0.00     19193\n","     class 5       0.65      1.00      0.79     43734\n","\n","    accuracy                           0.65     67324\n","   macro avg       0.16      0.25      0.20     67324\n","weighted avg       0.42      0.65      0.51     67324\n","\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}]},{"cell_type":"code","source":["%%time\n","\n","from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint\n","\n","\n","learning_rate = 0.01\n","batch_size = 200\n","num_epochs = 500\n","\n","\n","checkpoint_path = \"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_oneMetric.ckpt\"\n","checkpoint_dir = os.path.dirname(\"/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/\")\n","\n","\n","callbacks = [tf.keras.callbacks.EarlyStopping(\n","                        monitor='val_loss',\n","                        mode='min', \n","                        verbose=1, \n","                        patience = 50,\n","                        restore_best_weights = True),          \n","              ModelCheckpoint(filepath=checkpoint_path, \n","                              # monitor='val_loss', \n","                              save_best_only=True\n","                              # , \n","                              # mode='min'\n","                              )]\n","\n","# callbacks = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_path,\n","#                                                  save_weights_only=True,\n","#                                                  verbose=1)\n","\n","\n","model = create_model()\n","\n","# Loads the weights\n","model.load_weights(checkpoint_path)\n","\n","\n","history = model.fit(dataset, \n","                    epochs = num_epochs,\n","                    validation_data = val_dataset,\n","                    class_weight = class_weights,\n","                    use_multiprocessing=True,\n","                    callbacks=callbacks\n","                    )\n","\n","\n","## Save the history\n","np.save('/content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/model_one_metric_history.npy',history.history)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Rll4U4Y1WkXF","executionInfo":{"status":"ok","timestamp":1651557244996,"user_tz":240,"elapsed":897256,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"3375582a-43d6-4197-c153-62af89d6436a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/500\n","1005/1010 [============================>.] - ETA: 0s - loss: 0.9887 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_oneMetric.ckpt/assets\n","1010/1010 [==============================] - 104s 102ms/step - loss: 0.9881 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9976 - val_mean_absolute_error_labels: 0.4421\n","Epoch 2/500\n","1010/1010 [==============================] - ETA: 0s - loss: 0.9882 - mean_absolute_error_labels: 0.4346INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_oneMetric.ckpt/assets\n","1010/1010 [==============================] - 94s 93ms/step - loss: 0.9882 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9976 - val_mean_absolute_error_labels: 0.4414\n","Epoch 3/500\n","1003/1010 [============================>.] - ETA: 0s - loss: 0.9888 - mean_absolute_error_labels: 0.4348INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_oneMetric.ckpt/assets\n","1010/1010 [==============================] - 92s 91ms/step - loss: 0.9881 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9976 - val_mean_absolute_error_labels: 0.4423\n","Epoch 4/500\n","1006/1010 [============================>.] - ETA: 0s - loss: 0.9885 - mean_absolute_error_labels: 0.4347INFO:tensorflow:Assets written to: /content/gdrive/My Drive/Colab Notebooks/CS6120NLP_FinalProject/Models/classifiers/training/cp_oneMetric.ckpt/assets\n","1010/1010 [==============================] - 93s 92ms/step - loss: 0.9881 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9976 - val_mean_absolute_error_labels: 0.4427\n","Epoch 5/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9983 - val_mean_absolute_error_labels: 0.4421\n","Epoch 6/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9881 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9978 - val_mean_absolute_error_labels: 0.4418\n","Epoch 7/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9881 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4416\n","Epoch 8/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9881 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9980 - val_mean_absolute_error_labels: 0.4425\n","Epoch 9/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4413\n","Epoch 10/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9981 - val_mean_absolute_error_labels: 0.4419\n","Epoch 11/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4421\n","Epoch 12/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4416\n","Epoch 13/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9879 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9976 - val_mean_absolute_error_labels: 0.4424\n","Epoch 14/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9878 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4424\n","Epoch 15/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9878 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4436\n","Epoch 16/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9879 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4418\n","Epoch 17/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4346 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4418\n","Epoch 18/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9879 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4413\n","Epoch 19/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4414\n","Epoch 20/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9879 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4410\n","Epoch 21/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4416\n","Epoch 22/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4416\n","Epoch 23/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9880 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4408\n","Epoch 24/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9878 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4433\n","Epoch 25/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9878 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4413\n","Epoch 26/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9879 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9978 - val_mean_absolute_error_labels: 0.4421\n","Epoch 27/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9878 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4419\n","Epoch 28/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9876 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4414\n","Epoch 29/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9877 - mean_absolute_error_labels: 0.4345 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4425\n","Epoch 30/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9878 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4422\n","Epoch 31/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9877 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4426\n","Epoch 32/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9876 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4419\n","Epoch 33/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9875 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4411\n","Epoch 34/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9875 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9981 - val_mean_absolute_error_labels: 0.4425\n","Epoch 35/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9876 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9985 - val_mean_absolute_error_labels: 0.4422\n","Epoch 36/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9875 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4419\n","Epoch 37/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9875 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9984 - val_mean_absolute_error_labels: 0.4410\n","Epoch 38/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9874 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9982 - val_mean_absolute_error_labels: 0.4415\n","Epoch 39/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9873 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9982 - val_mean_absolute_error_labels: 0.4423\n","Epoch 40/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9875 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4418\n","Epoch 41/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9872 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9983 - val_mean_absolute_error_labels: 0.4421\n","Epoch 42/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9872 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9980 - val_mean_absolute_error_labels: 0.4421\n","Epoch 43/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9871 - mean_absolute_error_labels: 0.4342 - val_loss: 0.9980 - val_mean_absolute_error_labels: 0.4417\n","Epoch 44/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9872 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9984 - val_mean_absolute_error_labels: 0.4427\n","Epoch 45/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9873 - mean_absolute_error_labels: 0.4344 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4423\n","Epoch 46/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9870 - mean_absolute_error_labels: 0.4342 - val_loss: 0.9978 - val_mean_absolute_error_labels: 0.4414\n","Epoch 47/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9871 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9978 - val_mean_absolute_error_labels: 0.4429\n","Epoch 48/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9870 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4421\n","Epoch 49/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9869 - mean_absolute_error_labels: 0.4342 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4420\n","Epoch 50/500\n","1010/1010 [==============================] - 6s 5ms/step - loss: 0.9870 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4418\n","Epoch 51/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9869 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9979 - val_mean_absolute_error_labels: 0.4419\n","Epoch 52/500\n","1010/1010 [==============================] - 5s 5ms/step - loss: 0.9870 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9980 - val_mean_absolute_error_labels: 0.4410\n","Epoch 53/500\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9870 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9977 - val_mean_absolute_error_labels: 0.4410\n","Epoch 54/500\n","1010/1010 [==============================] - ETA: 0s - loss: 0.9867 - mean_absolute_error_labels: 0.4343Restoring model weights from the end of the best epoch: 4.\n","1010/1010 [==============================] - 6s 6ms/step - loss: 0.9867 - mean_absolute_error_labels: 0.4343 - val_loss: 0.9980 - val_mean_absolute_error_labels: 0.4417\n","Epoch 54: early stopping\n","CPU times: user 10min 31s, sys: 1min 54s, total: 12min 25s\n","Wall time: 14min 57s\n"]}]},{"cell_type":"code","source":["model.evaluate(test_dataset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GUJOiZfbf4ZS","executionInfo":{"status":"ok","timestamp":1651557505496,"user_tz":240,"elapsed":2892,"user":{"displayName":"Lakshyana","userId":"14846287915491486779"}},"outputId":"c5b7b7ff-ae31-4d69-8e03-244ba63e7a33"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["270/270 [==============================] - 2s 6ms/step - loss: 0.9661 - mean_absolute_error_labels: 0.4296\n"]},{"output_type":"execute_result","data":{"text/plain":["[0.9660837650299072, 0.42959195375442505]"]},"metadata":{},"execution_count":49}]}],"metadata":{"colab":{"collapsed_sections":["na2otCwqvaw_","nnOSXwTYOWId"],"name":"Feedforwad Ordinal Classification Model","provenance":[{"file_id":"1NANwMIwEbSJVPx86TT54REZ9kAOCZG13","timestamp":1650297476074}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}